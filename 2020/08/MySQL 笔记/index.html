<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>MySQL 笔记 | ActionDing</title><meta name="keywords" content="数据库"><meta name="author" content="丁康健"><meta name="copyright" content="丁康健"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第一章 MySQL概述MySQL是一个关系型数据库管理系统，由瑞典MySQL AB公司开发，属于Oracle旗下产品。MySQL是最流行的关系型数据库管理系统之一。 1.1 数据库的常见概念1.1.1 DBDatabase，数据库，存储数据的容器 1.1.2 DBMSDatabase Management System，数据库管理系统，又称为数据库软件或数据库产品，用于创建或管理数据库 1.1.3">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 笔记">
<meta property="og:url" content="https://actionding.github.io/2020/08/MySQL%20%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="ActionDing">
<meta property="og:description" content="第一章 MySQL概述MySQL是一个关系型数据库管理系统，由瑞典MySQL AB公司开发，属于Oracle旗下产品。MySQL是最流行的关系型数据库管理系统之一。 1.1 数据库的常见概念1.1.1 DBDatabase，数据库，存储数据的容器 1.1.2 DBMSDatabase Management System，数据库管理系统，又称为数据库软件或数据库产品，用于创建或管理数据库 1.1.3">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2020-08-04T19:02:01.000Z">
<meta property="article:modified_time" content="2022-03-08T12:42:07.394Z">
<meta property="article:author" content="丁康健">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://actionding.github.io/2020/08/MySQL%20%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL 笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-08 20:42:07'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="ActionDing" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2022/03/08/NatumZBRC4zSi8Q.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/musics/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ActionDing</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/musics/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL 笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-04T19:02:01.000Z" title="发表于 2020-08-05 03:02:01">2020-08-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-08T12:42:07.394Z" title="更新于 2022-03-08 20:42:07">2022-03-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MySQL 笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="第一章-MySQL概述"><a href="#第一章-MySQL概述" class="headerlink" title="第一章 MySQL概述"></a>第一章 MySQL概述</h2><p>MySQL是一个<strong>关系型数据库管理系统</strong>，由瑞典MySQL AB公司开发，属于Oracle旗下产品。MySQL是最流行的关系型数据库管理系统之一。</p>
<h3 id="1-1-数据库的常见概念"><a href="#1-1-数据库的常见概念" class="headerlink" title="1.1 数据库的常见概念"></a>1.1 数据库的常见概念</h3><h4 id="1-1-1-DB"><a href="#1-1-1-DB" class="headerlink" title="1.1.1 DB"></a>1.1.1 DB</h4><p>Database，数据库，存储数据的容器</p>
<h4 id="1-1-2-DBMS"><a href="#1-1-2-DBMS" class="headerlink" title="1.1.2 DBMS"></a>1.1.2 DBMS</h4><p>Database Management System，数据库管理系统，又称为数据库软件或数据库产品，用于创建或管理数据库</p>
<h4 id="1-1-3-SQL"><a href="#1-1-3-SQL" class="headerlink" title="1.1.3 SQL"></a>1.1.3 SQL</h4><p>Structured Query Language，结构化查询语言，用于和数据库通信的语言，不是某个数据库软件特有的，而是几乎所有的主流数据库软件通用的语言</p>
<blockquote>
<p>常见的数据库管理系统：MySQL、Oracle、db2、SQLserver</p>
</blockquote>
<h3 id="1-2-MySQL的介绍"><a href="#1-2-MySQL的介绍" class="headerlink" title="1.2 MySQL的介绍"></a>1.2 MySQL的介绍</h3><p>MySQL是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，属于Oracle 旗下产品</p>
<p>08年被SUN公司收购，09年SUN被Oracle收购</p>
<p>属于<strong>C&#x2F;S架构</strong>的软件，一般安装服务端</p>
<p>分为<strong>企业版</strong>和<strong>社区版</strong></p>
<h3 id="1-3-MySQL的优点"><a href="#1-3-MySQL的优点" class="headerlink" title="1.3 MySQL的优点"></a>1.3 MySQL的优点</h3><p>1、开源、免费、成本低<br>2、性能高、移植性也好<br>3、体积小，便于安装</p>
<h3 id="1-4-MySQL语言的分类"><a href="#1-4-MySQL语言的分类" class="headerlink" title="1.4 MySQL语言的分类"></a>1.4 MySQL语言的分类</h3><h4 id="1-4-1-DML"><a href="#1-4-1-DML" class="headerlink" title="1.4.1 DML"></a>1.4.1 DML</h4><p>Data Manipulation Language：数据操纵语句，用于添加、删除、修改、查询数据库记录，并检查数据完整性</p>
<h4 id="1-4-2-DDL"><a href="#1-4-2-DDL" class="headerlink" title="1.4.2 DDL"></a>1.4.2 DDL</h4><p>Data Definition Language：数据定义语句，用于库和表的创建、修改、删除。</p>
<h4 id="1-4-3-DCL"><a href="#1-4-3-DCL" class="headerlink" title="1.4.3 DCL"></a>1.4.3 DCL</h4><p>Data Control Language：数据控制语句，用于定义用户的访问权限和安全级别。</p>
<h3 id="1-5-MySQL服务的启动和停止"><a href="#1-5-MySQL服务的启动和停止" class="headerlink" title="1.5 MySQL服务的启动和停止"></a>1.5 MySQL服务的启动和停止</h3><p>方式一：通过命令行</p>
<p>​    <code>net start [服务名]</code><br>​    <code>net stop [服务名]</code></p>
<p>方式二：计算机——右击——管理——服务</p>
<h3 id="1-6-MySQL服务的登录和退出"><a href="#1-6-MySQL服务的登录和退出" class="headerlink" title="1.6 MySQL服务的登录和退出"></a>1.6 MySQL服务的登录和退出</h3><p>登录：<code>mysql [-h 主机名 -P 端口号] -u[用户名] -p[密码]</code></p>
<p>退出：<code>exit</code> 或 <code>ctrl+C</code></p>
<hr>
<h2 id="第二章-DQL语言"><a href="#第二章-DQL语言" class="headerlink" title="第二章 DQL语言"></a>第二章 DQL语言</h2><p>DQL（Data Query Language）：数据查询语言，用来查询记录（数据）</p>
<h3 id="2-1-基础查询"><a href="#2-1-基础查询" class="headerlink" title="2.1 基础查询"></a>2.1 基础查询</h3><p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">  查询列表 </span><br><span class="line">FROM</span><br><span class="line">  表名 ;</span><br></pre></td></tr></table></figure>

<p>查询列表：表中的字段、常量值、表达式、函数</p>
<p>查询的结果是一个虚拟的表格</p>
<h4 id="2-1-1-查询表中的单个字段"><a href="#2-1-1-查询表中的单个字段" class="headerlink" title="2.1.1 查询表中的单个字段"></a>2.1.1 查询表中的单个字段</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT last_name FROM employees;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-查询表中的多个字段"><a href="#2-1-2-查询表中的多个字段" class="headerlink" title="2.1.2 查询表中的多个字段"></a>2.1.2 查询表中的多个字段</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT last_name,salary,email FROM employees;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-3-查询表中的所有字段"><a href="#2-1-3-查询表中的所有字段" class="headerlink" title="2.1.3 查询表中的所有字段"></a>2.1.3 查询表中的所有字段</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">  `employee_id`,</span><br><span class="line">  `first_name`,</span><br><span class="line">  `last_name`,</span><br><span class="line">  `email`,</span><br><span class="line">  `phone_number`,</span><br><span class="line">  `job_id`,</span><br><span class="line">  `salary`,</span><br><span class="line">  `commission_pct`,</span><br><span class="line">  `manager_id`,</span><br><span class="line">  `department_id`,</span><br><span class="line">  `hiredate` </span><br><span class="line">FROM</span><br><span class="line">  `employees` ;</span><br><span class="line">/*</span><br><span class="line"> * F12 格式化</span><br><span class="line"> * 不是引号，是着重号，用来区分字段和关键字</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>

<p><strong>或</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM employees;</span><br><span class="line"># 表中字段顺序固定</span><br></pre></td></tr></table></figure>

<h4 id="2-1-4-查询常量值"><a href="#2-1-4-查询常量值" class="headerlink" title="2.1.4 查询常量值"></a>2.1.4 查询常量值</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT 100;</span><br><span class="line">SELECT &#x27;john&#x27;;</span><br><span class="line"># 不区分字符和字符串，都是字符型，用单引号</span><br></pre></td></tr></table></figure>

<h4 id="2-1-5-查询表达式"><a href="#2-1-5-查询表达式" class="headerlink" title="2.1.5 查询表达式"></a>2.1.5 查询表达式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 100%98;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-6-查询函数"><a href="#2-1-6-查询函数" class="headerlink" title="2.1.6 查询函数"></a>2.1.6 查询函数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT VERSION();</span><br></pre></td></tr></table></figure>

<h4 id="2-1-7-起别名"><a href="#2-1-7-起别名" class="headerlink" title="2.1.7 起别名"></a>2.1.7 起别名</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 方式一：使用as</span><br><span class="line">SELECT 100%98 AS 结果;</span><br><span class="line">SELECT last_name AS 姓,first_name AS 名 FROM employees;</span><br><span class="line">/*</span><br><span class="line"> *1 便于理解</span><br><span class="line"> *2 如果要查询的字段有重名的情况，使用别名可以区分开来</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 方式二：使用空格</span><br><span class="line">SELECT last_name 姓,first_name 名 FROM employees;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 案例：查询salary，显示结果为 out put</span><br><span class="line">SELECT salary AS &quot;out put&quot; FROM employees;</span><br><span class="line"># 这里建议使用双引号，单引号也可以</span><br></pre></td></tr></table></figure>

<h4 id="2-1-8-去重"><a href="#2-1-8-去重" class="headerlink" title="2.1.8 去重"></a>2.1.8 去重</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 使用DISTINCT关键字</span><br><span class="line">SELECT DISTINCT department_id FROM employees;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-9-号的使用"><a href="#2-1-9-号的使用" class="headerlink" title="2.1.9 +号的使用"></a>2.1.9 <code>+</code>号的使用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"></span><br><span class="line">java中的+号：</span><br><span class="line">①运算符，两个操作数都为数值型</span><br><span class="line">②连接符，只要有一个操作数为字符串</span><br><span class="line"></span><br><span class="line">mysql中的+号：</span><br><span class="line">仅仅只有一个功能：运算符</span><br><span class="line"></span><br><span class="line">select 100+90; 两个操作数都为数值型，则做加法运算</span><br><span class="line">select &#x27;123&#x27;+90;只要其中一方为字符型，试图将字符型数值转换成数值型</span><br><span class="line">			如果转换成功，则继续做加法运算</span><br><span class="line">select &#x27;john&#x27;+90;	如果转换失败，则将字符型数值转换成0</span><br><span class="line"></span><br><span class="line">select null+10; 只要其中一方为null，则结果肯定为null</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"># 案例:查询员工名和姓连接成一个字段，并显示为 姓名</span><br><span class="line"></span><br><span class="line">SELECT CONCAT(&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;) AS 结果;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">  错误的写法</span><br><span class="line">select </span><br><span class="line">  last_name + first_name as 姓名 </span><br><span class="line">from</span><br><span class="line">  employees ;</span><br><span class="line">*/</span><br><span class="line"># 正确的写法，使用CONCAT()函数</span><br><span class="line">SELECT </span><br><span class="line">  CONCAT(`first_name`, `last_name`) AS 姓名 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br></pre></td></tr></table></figure>

<h4 id="附：几个函数"><a href="#附：几个函数" class="headerlink" title="附：几个函数"></a>附：几个函数</h4><p>1）<code>concat() </code>函数</p>
<p>功能：拼接字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CONCAT(str1，str2，str3,...);</span><br></pre></td></tr></table></figure>

<p>2）<code>ifnull()</code> 函数</p>
<p>功能：判断某字段或表达式是否为<code>null</code>，如果为<code>null</code>返回指定的值，否则返回原本的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT IFNULL(commission_pct,0) from employees;</span><br></pre></td></tr></table></figure>

<p>3）<code>isnull()</code> 函数</p>
<p>功能：判断某字段或表达式是否为null，如果是，则返回1，否则返回0</p>
<h3 id="2-2-条件查询"><a href="#2-2-条件查询" class="headerlink" title="2.2 条件查询"></a>2.2 条件查询</h3><p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">  查询列表 </span><br><span class="line">FROM</span><br><span class="line">  表名 </span><br><span class="line">WHERE 筛选条件 ;</span><br></pre></td></tr></table></figure>

<p>筛选条件的分类：</p>
<p>1）简单条件运算符</p>
<p>2）逻辑运算符</p>
<p>3）模糊查询</p>
<h4 id="2-2-1-简单条件运算符"><a href="#2-2-1-简单条件运算符" class="headerlink" title="2.2.1 简单条件运算符"></a>2.2.1 简单条件运算符</h4><table>
<thead>
<tr>
<th align="center">&gt;</th>
<th>&lt;</th>
<th align="center">&#x3D;</th>
<th align="center">!&#x3D;</th>
<th align="center">&lt;&gt;</th>
<th align="center">&gt;&#x3D;</th>
<th align="center">&lt;&#x3D;</th>
<th align="center">&lt;&#x3D;&gt;</th>
</tr>
</thead>
<tbody><tr>
<td align="center">大于</td>
<td>小于</td>
<td align="center">等于</td>
<td align="center">不等于</td>
<td align="center">不等于</td>
<td align="center">大于等于</td>
<td align="center">小于等于</td>
<td align="center">安全等于</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询工资 &gt; 12000的员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &gt; 12000 ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询部门编号不等于90号的员工名和部门编号</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE department_id &lt;&gt; 90 ;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-逻辑运算符"><a href="#2-2-2-逻辑运算符" class="headerlink" title="2.2.2 逻辑运算符"></a>2.2.2 逻辑运算符</h4><table>
<thead>
<tr>
<th align="center">&amp;&amp;</th>
<th align="center">||</th>
<th align="center">!</th>
</tr>
</thead>
<tbody><tr>
<td align="center">and</td>
<td align="center">or</td>
<td align="center">not</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询工资在10000到20000之间的员工名、工资以及奖金</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  salary,</span><br><span class="line">  commission_pct </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &gt; 10000 </span><br><span class="line">  AND salary &lt; 20000 ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询部门编号不是在90到100之间，或者工资高于15000的员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE department_id &lt; 90 </span><br><span class="line">  OR department_id &gt; 110 </span><br><span class="line">  OR salary &gt; 15000 ;</span><br><span class="line">/*</span><br><span class="line">WHERE not (</span><br><span class="line">    department_id &gt;= 90 </span><br><span class="line">    AND department_id &lt;= 110</span><br><span class="line">  ) </span><br><span class="line">  OR salary &gt; 15000 ;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-模糊查询"><a href="#2-2-3-模糊查询" class="headerlink" title="2.2.3 模糊查询"></a>2.2.3 模糊查询</h4><p>1）<code>like</code>:一般搭<strong>配通配符</strong>使用，可以判断字符型或数值型</p>
<p>通配符：</p>
<ul>
<li><p>%任意多个字符，，包含0个字符</p>
</li>
<li><p>_任意单个字符</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询员工名中包含字符a的员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE last_name LIKE &#x27;%a%&#x27; ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询员工名中第三个字符为c，第五个字符为h的员工名和工资</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE last_name LIKE &#x27;__c_h%&#x27; ;</span><br><span class="line"></span><br><span class="line"># 案例三：查询员工名中第二个字符为_的员工名</span><br><span class="line">SELECT </span><br><span class="line">  last_name </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE last_name LIKE &#x27;_\_%&#x27; ;</span><br><span class="line"># WHERE last_name LIKE &#x27;_$_%&#x27; ESCAPE &#x27;$&#x27;;</span><br><span class="line"># 关键字ESCAPE：转义</span><br></pre></td></tr></table></figure>

<p>2） <code>between and</code></p>
<ul>
<li>使用between and可以提高语句的简洁度</li>
<li>包含临界值</li>
<li>两个临界值不要调换顺序</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询员工编号在100到120之间的员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE employee_id BETWEEN 100 </span><br><span class="line">  AND 120 ;</span><br><span class="line"># 等价于</span><br><span class="line"># employee_id &gt;= 100 AND employee_id &lt;= 120;</span><br></pre></td></tr></table></figure>

<p>3）<code>in</code><br>含义：判断某字段的值是否属于in列表中的某一项<br>特点：</p>
<ul>
<li>使用in提高语句简洁度</li>
<li>in列表的值类型必须统一或兼容</li>
<li>in列表中不能使用通配符</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 案例：查询员工的工种编号是 ITPROG、AD_VP、AD_PRES中的一个员工名和工种编号</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE job_id IN (&#x27;ITPROG&#x27;, &#x27;AD_VP&#x27;, &#x27;AD_PRES&#x27;) ;</span><br><span class="line"># WHERE job_id IN (&#x27;ITPROG&#x27;, &#x27;AD_%&#x27;) ; # 错误</span><br><span class="line">/*</span><br><span class="line">WHERE job_id = &#x27;ITPROG&#x27; </span><br><span class="line">  OR job_id = &#x27;AD_VP&#x27; </span><br><span class="line">  OR job_id = &#x27;AD_PRES&#x27; ;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<p>4） <code>is null</code> &#x2F;<code>is not null</code>：用于判断null值</p>
<blockquote>
<p>&#x3D; 或 &lt;&gt; 不能用于判断null值</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询没有奖金的员工名和奖金率</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  commission_pct</span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE commission_pct IS NULL ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询有奖金的员工名和奖金率</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  commission_pct</span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE commission_pct IS NOT NULL ;</span><br></pre></td></tr></table></figure>

<p><strong>附</strong></p>
<p><code>IS NULL</code> pk <code>&lt;=&gt;</code><br><code>IS NULL</code>：仅仅可以判断NULL值，可读性较高，建议使用<br><code>&lt;=&gt; </code>：既可以判断NULL值，有可以判断普通的数值，可读性较低</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 安全等于 &lt;=&gt;</span><br><span class="line"># 案例1：查询没有奖金的员工名和奖金率</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  commission_pct</span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE commission_pct &lt;=&gt; NULL ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询工资为12000的员工信息</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  salary</span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &lt;=&gt; 12000 ;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-排序查询"><a href="#2-3-排序查询" class="headerlink" title="2.3 排序查询"></a>2.3 排序查询</h3><h4 id="2-3-1-语法"><a href="#2-3-1-语法" class="headerlink" title="2.3.1 语法"></a>2.3.1 语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">  查询列表 </span><br><span class="line">FROM</span><br><span class="line">  表 </span><br><span class="line">WHERE 【筛选条件】 </span><br><span class="line">ORDER BY 排序列表【 ASC | DESC 】</span><br></pre></td></tr></table></figure>

<h4 id="2-3-2-特点"><a href="#2-3-2-特点" class="headerlink" title="2.3.2 特点"></a>2.3.2 特点</h4><p>​    1 asc表示升序，desc表示降序，如果不写，默认升序<br>​    2 order by 子句中可以支持单个字段、多个字段、表达式、函数、别名<br>​    3 order by 子句一般放在查询语句的最后面，limit子句除外</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询员工信息，要求工资从高到低排序</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">ORDER BY salary ASC ;</span><br><span class="line"># ORDER BY salary ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">ORDER BY salary DESC ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询部门编号大于等于90的员工信息，按入职时间的先后进行排序</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE department_id &gt;= 90 </span><br><span class="line">ORDER BY hiredate ASC ;</span><br><span class="line"></span><br><span class="line"># 案例3：按年薪的高低显示员工的选型和年薪【按表达式排序】</span><br><span class="line">SELECT </span><br><span class="line">  *,</span><br><span class="line">  salary * 12 * (1 + IFNULL(commission_pct, 0)) 年薪 </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">ORDER BY salary * 12 * (1 + IFNULL(commission_pct, 0)) DESC ;</span><br><span class="line"></span><br><span class="line"># 案例4：按年薪的高低显示员工的选型和年薪【按别名排序】</span><br><span class="line">SELECT </span><br><span class="line">  *,</span><br><span class="line">  salary * 12 * (1 + IFNULL(commission_pct, 0)) 年薪 </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">ORDER BY 年薪 DESC ;</span><br><span class="line"></span><br><span class="line"># 案例5：按姓名的长度显示员工的姓名和工资【按函数排序】</span><br><span class="line">SELECT </span><br><span class="line">  LENGTH(last_name) 字节长度,</span><br><span class="line">  last_name,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">ORDER BY LENGTH(last_name) DESC ;</span><br><span class="line"></span><br><span class="line"># 案例6：查询员工信息，要求先按工资排序，再按员工编号排序【按多个字段排序】</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">ORDER BY salary ASC,</span><br><span class="line">  employee_id DESC ;</span><br></pre></td></tr></table></figure>

<h4 id="附：常见函数"><a href="#附：常见函数" class="headerlink" title="附：常见函数"></a>附：常见函数</h4><p>1）字符函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"># 1. length 获取参数值的字节个数</span><br><span class="line">SELECT </span><br><span class="line">  LENGTH(&#x27;john&#x27;) ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  LENGTH(&#x27;张三丰hhh&#x27;) ;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;%char%&#x27; ;</span><br><span class="line"></span><br><span class="line"># 2. concat 拼接字符串</span><br><span class="line">SELECT </span><br><span class="line">  CONCAT(last_name, &#x27;_&#x27;, first_name) 姓名 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 3. upper、lower </span><br><span class="line">SELECT </span><br><span class="line">  UPPER(&#x27;john&#x27;) ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  LOWER(&#x27;John&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 案例：将姓变大写，名变小写，然后拼接</span><br><span class="line">SELECT </span><br><span class="line">  CONCAT(</span><br><span class="line">    UPPER(last_name),</span><br><span class="line">    &#x27;_&#x27;,</span><br><span class="line">    LOWER(first_name)</span><br><span class="line">  ) 姓名 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 4. substr、substring </span><br><span class="line"># 注意：索引从1开始</span><br><span class="line"></span><br><span class="line"># 截取从指定索引处后面所有字符</span><br><span class="line">SELECT </span><br><span class="line">  SUBSTR(</span><br><span class="line">    &#x27;李莫愁爱上了陆展元&#x27;,</span><br><span class="line">    7</span><br><span class="line">  ) out_put ;</span><br><span class="line"></span><br><span class="line"># 截取从指定索引处指定长度的字符</span><br><span class="line">SELECT </span><br><span class="line">  SUBSTR(</span><br><span class="line">    &#x27;李莫愁爱上了陆展元&#x27;,</span><br><span class="line">    1,</span><br><span class="line">    3</span><br><span class="line">  ) out_put ;</span><br><span class="line"></span><br><span class="line"># 案例：姓名中首字符大写，其他字符小写，然后用_拼接，显示出来</span><br><span class="line">SELECT </span><br><span class="line">  CONCAT(</span><br><span class="line">    UPPER(SUBSTR(last_name, 1, 1)),</span><br><span class="line">    &#x27;_&#x27;,</span><br><span class="line">    LOWER(SUBSTR(last_name, 2))</span><br><span class="line">  ) out_put </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 5. instr 返回子串第一次出现的索引，如果找不到，返回0</span><br><span class="line">SELECT </span><br><span class="line">  INSTR(</span><br><span class="line">    &#x27;杨不悔爱上了殷六侠&#x27;,</span><br><span class="line">    &#x27;殷六侠&#x27;</span><br><span class="line">  ) AS out_put ;</span><br><span class="line"></span><br><span class="line"># 6. trim</span><br><span class="line">SELECT </span><br><span class="line">  LENGTH(TRIM(&#x27;    张翠山    &#x27;)) AS out_put ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  TRIM(&#x27;a&#x27; FROM &#x27;aaa张aaa翠aaa山aaa&#x27;) AS out_put ;</span><br><span class="line"></span><br><span class="line"># 7. lpad 用指定的字符实现左填充指定长度</span><br><span class="line">SELECT </span><br><span class="line">  LPAD(&#x27;殷素素&#x27;, 10, &#x27;*&#x27;) AS out_put ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  LPAD(&#x27;殷素素&#x27;, 2, &#x27;*&#x27;) AS out_put ;</span><br><span class="line"></span><br><span class="line"># 8. rpad 用指定的字符实现做右充指定长度</span><br><span class="line">SELECT </span><br><span class="line">  RPAD(&#x27;殷素素&#x27;, 10, &#x27;*&#x27;) AS out_put ;</span><br><span class="line"></span><br><span class="line"># 9. replace 替换</span><br><span class="line">SELECT </span><br><span class="line">  REPLACE(</span><br><span class="line">    &#x27;张无忌爱上了周芷若&#x27;,</span><br><span class="line">    &#x27;周芷若&#x27;,</span><br><span class="line">    &#x27;赵敏&#x27;</span><br><span class="line">  ) AS out_put ;</span><br></pre></td></tr></table></figure>

<p>2）数学函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 1. round 四舍五入</span><br><span class="line">SELECT </span><br><span class="line">  ROUND(1.65) ; # 2</span><br><span class="line"># ROUND(1.45) ; # 1</span><br><span class="line"># ROUND(-1.65) ; # -2</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  ROUND(1.654,2) ; # 1.65</span><br><span class="line">  </span><br><span class="line"># 2. ceil 向上取整，返回 &gt;=该参数的最小整数</span><br><span class="line">SELECT </span><br><span class="line">  CEIL(1.002) ;</span><br><span class="line"># CEIL(-1.002); # -1</span><br><span class="line"></span><br><span class="line"># 3. floor 向下取整，，返回 &lt;=该参数的最大整数</span><br><span class="line">SELECT </span><br><span class="line">  FLOOR(- 9.99) ; # -10</span><br><span class="line">  </span><br><span class="line"># 4. truncate 截断</span><br><span class="line">SELECT </span><br><span class="line">  TRUNCATE(1.6999, 1) ; # 1.6</span><br><span class="line"># 5. mod 取模、取余</span><br><span class="line"># a mod b --&gt; a-a/b*b</span><br><span class="line">SELECT </span><br><span class="line">  MOD(10, 3) ;</span><br><span class="line"> </span><br><span class="line">SELECT </span><br><span class="line">  10 % 3 ;</span><br></pre></td></tr></table></figure>

<p>3）日期函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"># 1. now 返回当前系统日期 + 时间</span><br><span class="line">SELECT </span><br><span class="line">  NOW() ;</span><br><span class="line"></span><br><span class="line"># 2. curdate 返回当前系统日期，不包含时间</span><br><span class="line">SELECT </span><br><span class="line">  CURDATE() ;</span><br><span class="line"></span><br><span class="line"># 3. curtime 返回当前系统时间，不包含日期</span><br><span class="line">SELECT </span><br><span class="line">  CURTIME() ;</span><br><span class="line"></span><br><span class="line"># 4. 可以获取指定的部分，年、月、日、小时、分钟、秒</span><br><span class="line">SELECT </span><br><span class="line">  YEAR(NOW()) 年 ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  YEAR(&#x27;1997-1-1&#x27;) 年 ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  YEAR(hiredate) 年 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  MONTH(NOW()) 月 ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  DAY(NOW()) 日 ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  HOUR(NOW()) 时 ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  MINUTE(NOW()) 分 ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  SECOND(NOW()) 秒 ;</span><br><span class="line"></span><br><span class="line"># 5. str_to_date 将日期格式的字符转换为指定格式的日期</span><br><span class="line">SELECT </span><br><span class="line">  STR_TO_DATE(&#x27;1997-3-2&#x27;, &#x27;%Y-%c-%d&#x27;) AS out_put ;</span><br><span class="line">  </span><br><span class="line"># 案例：查询入职日期为1992-4-3的员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE hiredate = &#x27;1992-4-3&#x27; ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE hiredate = STR_TO_DATE(&#x27;4-3 1992&#x27;, &#x27;%c-%d %Y&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 6. date_format 将日期转换为字符</span><br><span class="line">SELECT </span><br><span class="line">  DATE_FORMAT(NOW(), &#x27;%y年%m月%d日&#x27;) AS out_put ;</span><br><span class="line"></span><br><span class="line"># 案例：查询有奖金的员工名和入职日期（xx月/xx日 xx年）</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  DATE_FORMAT(hiredate, &#x27;%m月/%d日 %y年&#x27;) 入职日期 </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE commission_pct IS NOT NULL ;</span><br></pre></td></tr></table></figure>

<p>4）流程控制函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"># 1. if函数：if else 的效果</span><br><span class="line">SELECT </span><br><span class="line">  IF(10 &gt; 5, &#x27;大&#x27;, &#x27;小&#x27;) ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  commission_pct,</span><br><span class="line">  IF(</span><br><span class="line">    commission_pct IS NULL,</span><br><span class="line">    &#x27;没奖金，呵呵&#x27;,</span><br><span class="line">    &#x27;有奖金，嘻嘻&#x27;</span><br><span class="line">  ) 备注 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 2. case函数的使用一：switch case 的效果</span><br><span class="line">/*</span><br><span class="line">Java中</span><br><span class="line">switch(变量或表达式)&#123;</span><br><span class="line">	case 常量1: 语句1; break; </span><br><span class="line">	...</span><br><span class="line">	default: 语句n; break;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MySQL中</span><br><span class="line">case 要判断的字段或表达式</span><br><span class="line">when 常量1 then 要显示的值1 或 语句1;</span><br><span class="line">when 常量2 then 要显示的值2 或 语句2;</span><br><span class="line">...</span><br><span class="line">else 要显示的值n 或 语句n;</span><br><span class="line">end</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">案例：查询员工的工资，要求</span><br><span class="line"></span><br><span class="line">部门号 = 30，显示的工资为1.1倍</span><br><span class="line">部门号 = 40，显示的工资为1.2倍</span><br><span class="line">部门号 = 50，显示的工资为1.3倍</span><br><span class="line">其他部门，显示的工资为原工资</span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">  salary 原始工资,</span><br><span class="line">  department_id,</span><br><span class="line">  CASE</span><br><span class="line">    department_id </span><br><span class="line">    WHEN 30 </span><br><span class="line">    THEN salary * 1.1 </span><br><span class="line">    WHEN 40 </span><br><span class="line">    THEN salary * 1.2 </span><br><span class="line">    WHEN 50 </span><br><span class="line">    THEN salary * 1.3 </span><br><span class="line">    ELSE salary </span><br><span class="line">  END AS 新工资 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># case函数的使用二：类似于 多重if</span><br><span class="line">/*</span><br><span class="line">java中</span><br><span class="line">if（条件1）&#123;</span><br><span class="line">	语句1</span><br><span class="line">&#125; else if（条件2）&#123;</span><br><span class="line">	语句2</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">else &#123;</span><br><span class="line">	语句n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MySQL中</span><br><span class="line">case </span><br><span class="line">when 条件1 then 要显示的值1 或 语句1;</span><br><span class="line">when 条件2 then 要显示的值2 或 语句2;</span><br><span class="line">...</span><br><span class="line">else 要显示的值n 或 语句n;</span><br><span class="line">end</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">案例：查询员工的工资情况</span><br><span class="line">如果工资 &gt; 20000, 显示A级别</span><br><span class="line">如果工资 &gt; 15000, 显示B级别</span><br><span class="line">如果工资 &gt; 10000, 显示C级别</span><br><span class="line">否则，显示D级别</span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">  salary,</span><br><span class="line">  CASE</span><br><span class="line">    WHEN salary &gt; 20000 </span><br><span class="line">    THEN &#x27;A&#x27; </span><br><span class="line">    WHEN salary &gt; 15000 </span><br><span class="line">    THEN &#x27;B&#x27; </span><br><span class="line">    WHEN salary &gt; 10000 </span><br><span class="line">    THEN &#x27;C&#x27; </span><br><span class="line">    ELSE &#x27;D&#x27; </span><br><span class="line">  END AS 工资级别 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br></pre></td></tr></table></figure>

<p>5）其他函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 1. version 查看版本号</span><br><span class="line">SELECT </span><br><span class="line">  VERSION() ;</span><br><span class="line"></span><br><span class="line"># 2. database 查看当前数据库</span><br><span class="line">SELECT </span><br><span class="line">  DATABASE() ;</span><br><span class="line"></span><br><span class="line"># 3. user 查看当前用户</span><br><span class="line">SELECT </span><br><span class="line">  USER() ;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-分组函数"><a href="#2-4-分组函数" class="headerlink" title="2.4 分组函数"></a>2.4 分组函数</h3><h4 id="2-4-1-功能"><a href="#2-4-1-功能" class="headerlink" title="2.4.1 功能"></a>2.4.1 功能</h4><p>​    用作统计使用，又称为<strong>聚合函数</strong> 或 <strong>统计函数</strong> 或 <strong>组函数</strong></p>
<h4 id="2-4-2-分类"><a href="#2-4-2-分类" class="headerlink" title="2.4.2 分类"></a>2.4.2 分类</h4><p>​    sum 求和、avg 平均值、max 最大值、min 最小值、count 计算个数</p>
<h4 id="2-4-3-特点"><a href="#2-4-3-特点" class="headerlink" title="2.4.3 特点"></a>2.4.3 特点</h4><ol>
<li>sum、avg一般用于处理<strong>数值类型</strong>；max、min、count可以处理<strong>任何类型</strong></li>
<li>以上分组函数都忽略null值</li>
<li>可以和distinct搭配实现去重的运算</li>
<li>count函数：一般使用count(*)用作统计行数</li>
<li>和分组函数一同查询的字段要求是group by后的字段</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"># 1 简单使用</span><br><span class="line">SELECT </span><br><span class="line">  SUM(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  MAX(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  MIN(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  COUNT(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  SUM(salary) 和,</span><br><span class="line">  ROUND(AVG(salary), 2) 平均,</span><br><span class="line">  MAX(salary) 最大,</span><br><span class="line">  MIN(salary) 最小,</span><br><span class="line">  COUNT(salary) 个数 </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 参数支持哪些类型</span><br><span class="line"># select sum(last_name), avg(last_name) from employees;</span><br><span class="line">SELECT </span><br><span class="line">  SUM(hiredate),</span><br><span class="line">  AVG(hiredate) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  MAX(last_name),</span><br><span class="line">  MIN(last_name) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  MAX(hiredate),</span><br><span class="line">  MIN(hiredate) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  COUNT(commission_pct) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 3 是否忽略null值</span><br><span class="line">SELECT </span><br><span class="line">  SUM(commission_pct),</span><br><span class="line">  AVG(commission_pct),</span><br><span class="line">  SUM(commission_pct)/35,</span><br><span class="line">  SUM(commission_pct)/107</span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  MAX(commission_pct),</span><br><span class="line">  MIN(commission_pct)</span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  COUNT(commission_pct)</span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line">  </span><br><span class="line"># 4 和distinct搭配</span><br><span class="line">SELECT </span><br><span class="line">  SUM(DISTINCT salary),</span><br><span class="line">  SUM(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  COUNT(DISTINCT salary),</span><br><span class="line">  COUNT(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 5 count函数的详细介绍</span><br><span class="line">SELECT </span><br><span class="line">  COUNT(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  COUNT(*) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line">  </span><br><span class="line">SELECT </span><br><span class="line">  COUNT(1) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">效率：</span><br><span class="line">myisam存储引擎下，count(*)的效率高</span><br><span class="line">innodb存储引擎下，COUNT(*)和COUNT(1)的效率差不多，比COUNT(字段)要高一些</span><br><span class="line">*/</span><br><span class="line"># 6 和分组函数一同查询的字段有限制</span><br><span class="line"></span><br><span class="line"># select avg(salary),employees_id from employee;</span><br><span class="line"># 和分组函数一同查询的字段要求是group by后的字段</span><br></pre></td></tr></table></figure>

<h3 id="2-5-分组查询"><a href="#2-5-分组查询" class="headerlink" title="2.5 分组查询"></a>2.5 分组查询</h3><h4 id="2-5-1-语法"><a href="#2-5-1-语法" class="headerlink" title="2.5.1 语法"></a>2.5.1 语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select 分组函数，列（要求出现在group by的后面）</span><br><span class="line">from 表名</span><br><span class="line">【where 筛选条件】</span><br><span class="line">group by 分组的列表</span><br><span class="line">【order by 子句】</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：查询列表必须特殊，要求是分组函数和group by后出现的字段</p>
</blockquote>
<h4 id="2-5-2-特点"><a href="#2-5-2-特点" class="headerlink" title="2.5.2 特点"></a>2.5.2 特点</h4><ol>
<li>分组查询中的筛选条件分为两类</li>
</ol>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">数据源</th>
<th align="center">位置</th>
<th align="center">关键字</th>
</tr>
</thead>
<tbody><tr>
<td align="center">分组前筛选</td>
<td align="center">原始表</td>
<td align="center">group by 子句的前面</td>
<td align="center">where</td>
</tr>
<tr>
<td align="center">分组后筛选</td>
<td align="center">分组后的结果集</td>
<td align="center">group by 子句的后面</td>
<td align="center">having</td>
</tr>
</tbody></table>
<blockquote>
<p>①分组函数做条件肯定是放在having子句中<br>②能用分组前筛选的，就优先考虑使用分组前筛选</p>
</blockquote>
<ol start="2">
<li>group by子句支持单个字段分组，多个字段分组（多个字段之间用逗号隔开，没有顺序要求），表达式或函数（用得较少）</li>
<li>也可以添加排序（排序放在整个分组查询的最后）</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询每个工种的最高工资</span><br><span class="line">SELECT </span><br><span class="line">  MAX(salary),</span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY job_id ;</span><br><span class="line"></span><br><span class="line"># 案例2： 查询每个位置上部门个数</span><br><span class="line">SELECT COUNT(*),location_id</span><br><span class="line">FROM departments</span><br><span class="line">GROUP BY location_id;</span><br><span class="line"></span><br><span class="line"># 添加筛选条件</span><br><span class="line"># 案例1：查询邮箱中包含a字符的，每个部门的平均工资</span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary),</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE email LIKE &#x27;%a%&#x27; </span><br><span class="line">GROUP BY department_id ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询有奖金的每个领导手下员工的最高工资</span><br><span class="line">SELECT MAX(salary),manager_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE commission_pct IS NOT NULL</span><br><span class="line">GROUP BY manager_id;</span><br><span class="line"></span><br><span class="line"># 添加复杂的筛选条件</span><br><span class="line"># 案例1：查询哪个部门的员工数 &gt; 2</span><br><span class="line"># ①查询每个部门的员工个数</span><br><span class="line">SELECT </span><br><span class="line">  COUNT(*),</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY department_id ;</span><br><span class="line"></span><br><span class="line"># ②根据①的结果进行筛选，查询哪个部门的员工数&gt;2</span><br><span class="line">SELECT </span><br><span class="line">  COUNT(*),</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY department_id </span><br><span class="line">HAVING COUNT(*)&gt;2;</span><br><span class="line"></span><br><span class="line"># 案例2：查询每个工种有奖金的员工的最高工资&gt;12000的工种编号和最高工资</span><br><span class="line"># ①查询每个工种有奖金的员工的最高工资</span><br><span class="line">SELECT </span><br><span class="line">  MAX(salary),</span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE commission_pct IS NOT NULL </span><br><span class="line">GROUP BY job_id ;</span><br><span class="line"></span><br><span class="line"># ②根据①结果继续筛选，最高工资 &gt; 12000</span><br><span class="line">SELECT </span><br><span class="line">  MAX(salary),</span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE commission_pct IS NOT NULL </span><br><span class="line">GROUP BY job_id </span><br><span class="line">HAVING MAX(salary) &gt; 12000 ;</span><br><span class="line"></span><br><span class="line"># 案例3：查询领导编号&gt;102的每个领导手下的最低工资&gt;5000的领导编号是哪个，以及其最低工资</span><br><span class="line"># ①查询每个领导手下的员工最低工资</span><br><span class="line">SELECT MIN(salary),manager_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY manager_id;</span><br><span class="line"></span><br><span class="line"># ②添加筛选条件：编号&gt;102</span><br><span class="line">SELECT </span><br><span class="line">  MIN(salary),</span><br><span class="line">  manager_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE manager_id &gt; 102 </span><br><span class="line">GROUP BY manager_id ;</span><br><span class="line"></span><br><span class="line"># ③添加筛选条件：最低工资&gt;5000</span><br><span class="line">SELECT </span><br><span class="line">  MIN(salary),</span><br><span class="line">  manager_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE manager_id &gt; 102 </span><br><span class="line">GROUP BY manager_id </span><br><span class="line">HAVING MIN(salary) &gt; 5000 ;</span><br><span class="line"></span><br><span class="line"># 按表达式或函数分组</span><br><span class="line"># 案例：按员工姓名的长度分组，查询每一组的员工个数，筛选员工个数&gt;5的有哪些</span><br><span class="line"># ①查询每个长度的员工个数</span><br><span class="line">SELECT </span><br><span class="line">  COUNT(*),</span><br><span class="line">  LENGTH(last_name) len_name </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY LENGTH(last_name) ;</span><br><span class="line"></span><br><span class="line"># ②添加筛选条件</span><br><span class="line">SELECT </span><br><span class="line">  COUNT(*) C,</span><br><span class="line">  LENGTH(last_name) len_name </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY len_name </span><br><span class="line">HAVING C &gt; 5 ;</span><br><span class="line"></span><br><span class="line"># 按多个字段分组</span><br><span class="line"># 案例：查询每个部门每个工种的员工的平均工资</span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary),</span><br><span class="line">  department_id,</span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY job_id,</span><br><span class="line">  department_id ;</span><br><span class="line"></span><br><span class="line"># 添加排序</span><br><span class="line"># 案例：查询每个部门每个工种的员工的平均工资，并且按平均工资的高低显示</span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary),</span><br><span class="line">  department_id,</span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE department_id IS NOT NULL </span><br><span class="line">GROUP BY job_id,</span><br><span class="line">  department_id </span><br><span class="line">HAVING AVG(salary) &gt; 10000 </span><br><span class="line">ORDER BY AVG(salary) DESC ;</span><br></pre></td></tr></table></figure>

<h3 id="2-5-连接查询"><a href="#2-5-连接查询" class="headerlink" title="2.5 连接查询"></a>2.5 连接查询</h3><h4 id="2-5-1-含义"><a href="#2-5-1-含义" class="headerlink" title="2.5.1 含义"></a>2.5.1 含义</h4><p>又称多表查询，当查询的字段来自于多个表时，就会用到连接查询</p>
<blockquote>
<p><strong>笛卡尔乘积现象</strong>：表1 有 m 行，表2有 n 行，结果有 m*n 行</p>
<p>发生原因：没有有效的连接条件<br>如何避免：添加有效的连接条件</p>
</blockquote>
<h4 id="2-5-2-分类"><a href="#2-5-2-分类" class="headerlink" title="2.5.2 分类"></a>2.5.2 分类</h4><p>1）按年代分类：<br>    ① sql92标准：仅仅支持内连接<br>    ② sql99标准【推荐】：支持内连接+外连接（左外和右外）+交叉连接<br>2）按功能分类：<br>    ① 内连接：等值连接、非等值连接、自连接<br>    ② 外连接：左外连接、右外连接、全外连接<br>    ③ 交叉连接</p>
<h4 id="2-5-3-sql92标准"><a href="#2-5-3-sql92标准" class="headerlink" title="2.5.3 sql92标准"></a>2.5.3 sql92标准</h4><p>1）等值连接</p>
<p>​    ① 多表等值连接的结果为多表的交集部分<br>​    ② n表连接，至少需要n-1个连接条件<br>​    ③ 多表的顺序没有要求<br>​    ④ 一般需要为表起别名<br>​    ⑤ 可以搭配前面介绍的所有子句使用，比如排序、分组、筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询女神名和对应的男神名</span><br><span class="line">SELECT </span><br><span class="line">  NAME,</span><br><span class="line">  boyName </span><br><span class="line">FROM</span><br><span class="line">  beaupty,</span><br><span class="line">  boys </span><br><span class="line">WHERE beauty.boyfriend_id = boys.id ;</span><br><span class="line"></span><br><span class="line">USE myemployees;</span><br><span class="line"># 案例2：查询员工名和对应的部门名</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  department_name </span><br><span class="line">FROM</span><br><span class="line">  employees,</span><br><span class="line">  departments </span><br><span class="line">WHERE employees.`department_id` = departments.`department_id` ;</span><br><span class="line"></span><br><span class="line"># 2、为表取别名</span><br><span class="line">/*</span><br><span class="line">①提高语句的简洁度</span><br><span class="line">②区分多个重名的字段</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"># 查询员工名、工种号、工种名</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  e.job_id,</span><br><span class="line">  job_title </span><br><span class="line">FROM</span><br><span class="line">  employees e,</span><br><span class="line">  jobs j</span><br><span class="line">WHERE e.`job_id` = j.`job_id` ;</span><br><span class="line"></span><br><span class="line"># 3、两个表的顺序是否可以调换</span><br><span class="line"># 查询员工名、工种号、工种名</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  e.job_id,</span><br><span class="line">  job_title </span><br><span class="line">FROM</span><br><span class="line">  jobs j,</span><br><span class="line">  employees e</span><br><span class="line">WHERE e.`job_id` = j.`job_id` ;</span><br><span class="line"></span><br><span class="line"># 4、可以加筛选吗？</span><br><span class="line"># 案例1：查询有奖金的员工名、部门名</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  department_name,</span><br><span class="line">  commission_pct </span><br><span class="line">FROM</span><br><span class="line">  employees e,</span><br><span class="line">  departments d </span><br><span class="line">WHERE e.`department_id` = d.`department_id` </span><br><span class="line">  AND e.`commission_pct` IS NOT NULL ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询城市名中第二个字符为o的部门名和城市名</span><br><span class="line">SELECT </span><br><span class="line">  department_name,</span><br><span class="line">  city </span><br><span class="line">FROM</span><br><span class="line">  departments d,</span><br><span class="line">  locations l </span><br><span class="line">WHERE d.`location_id` = l.`location_id` </span><br><span class="line">  AND city LIKE &#x27;_o%&#x27; ;</span><br><span class="line"></span><br><span class="line"># 5、可以加分组吗？</span><br><span class="line"># 案例1：查询每个城市的部门个数</span><br><span class="line">SELECT </span><br><span class="line">  COUNT(*) 个数,</span><br><span class="line">  city </span><br><span class="line">FROM</span><br><span class="line">  locations l,</span><br><span class="line">  departments d </span><br><span class="line">WHERE l.`location_id` = d.`location_id` </span><br><span class="line">GROUP BY city ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询有奖金的每个部门的部门名和部门的领导编号和该部门的最低工资</span><br><span class="line">SELECT </span><br><span class="line">  department_name,</span><br><span class="line">  d.manager_id,</span><br><span class="line">  MIN(salary) </span><br><span class="line">FROM</span><br><span class="line">  departments d,</span><br><span class="line">  employees e </span><br><span class="line">WHERE d.`department_id` = e.`department_id`</span><br><span class="line">  AND commission_pct IS NOT NULL </span><br><span class="line">GROUP BY department_name,</span><br><span class="line">  d.manager_id ;</span><br><span class="line"></span><br><span class="line"># 6、可以加排序吗？</span><br><span class="line"># 案例：查询每个工种的工种名和员工的个数，并且按员工个数降序</span><br><span class="line">SELECT </span><br><span class="line">  job_title,</span><br><span class="line">  COUNT(*) 个数 </span><br><span class="line">FROM</span><br><span class="line">  jobs j,</span><br><span class="line">  employees e </span><br><span class="line">WHERE e.`job_id` = j.`job_id` </span><br><span class="line">GROUP BY job_title </span><br><span class="line">ORDER BY COUNT(*) DESC ;</span><br><span class="line"></span><br><span class="line"># 7、可以实现三表连接吗？</span><br><span class="line"># 案例：查询员工名、部门名和所在的城市</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  department_name,</span><br><span class="line">  city </span><br><span class="line">FROM</span><br><span class="line">  employees e,</span><br><span class="line">  departments d,</span><br><span class="line">  locations l </span><br><span class="line">WHERE e.`department_id` = d.`department_id` </span><br><span class="line">  AND d.`location_id` = l.`location_id` ;</span><br><span class="line">#  and city like &#x27;s%&#x27; </span><br><span class="line"># order by last_name ;</span><br></pre></td></tr></table></figure>

<p>2）非等值连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询员工的工资和工资等级</span><br><span class="line"></span><br><span class="line">SELECT salary, grade_level</span><br><span class="line">FROM employees e, job_grades j</span><br><span class="line">WHERE salary BETWEEN j.`lowest_sal` AND j.`highest_sal`;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">CREATE TABLE job_grades (</span><br><span class="line">  grade_level VARCHAR (3),</span><br><span class="line">  lowest_sal int,</span><br><span class="line">  highest_sal int</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO job_grades</span><br><span class="line">VALUES (&#x27;A&#x27;, 1000, 2999);</span><br><span class="line"></span><br><span class="line">INSERT INTO job_grades</span><br><span class="line">VALUES (&#x27;B&#x27;, 3000, 5999);</span><br><span class="line"></span><br><span class="line">INSERT INTO job_grades</span><br><span class="line">VALUES(&#x27;C&#x27;, 6000, 9999);</span><br><span class="line"></span><br><span class="line">INSERT INTO job_grades</span><br><span class="line">VALUES(&#x27;D&#x27;, 10000, 14999);</span><br><span class="line"></span><br><span class="line">INSERT INTO job_grades</span><br><span class="line">VALUES(&#x27;E&#x27;, 15000, 24999);</span><br><span class="line"></span><br><span class="line">INSERT INTO job_grades</span><br><span class="line">VALUES(&#x27;F&#x27;, 25000, 40000);</span><br><span class="line"></span><br><span class="line">select * from job_grades;</span><br><span class="line"></span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<p>3）自连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 案例：查询员工名和上级领导名</span><br><span class="line">SELECT e.employee_id, e.last_name, m.employee_id, m.last_name</span><br><span class="line">FROM employees e, employees m</span><br><span class="line">WHERE e.`manager_id` = m.`employee_id`;</span><br></pre></td></tr></table></figure>

<h4 id="2-5-4-sql99标准"><a href="#2-5-4-sql99标准" class="headerlink" title="2.5.4 sql99标准"></a>2.5.4 sql99标准</h4><p><strong>语法</strong>    </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">	from 表1 别名 【连接类型】</span><br><span class="line">	join 表2 别名</span><br><span class="line">	on 连接条件</span><br><span class="line">	【where 筛选条件】</span><br><span class="line">	【group by 分组】</span><br><span class="line">	【having 筛选条件】</span><br><span class="line">	【order by 排序列表】	</span><br></pre></td></tr></table></figure>

<p><strong>分类</strong></p>
<p>① 内连接（★）：inner</p>
<p>② 外连接</p>
<ul>
<li>左外（★）：left 【outer】</li>
<li>右外（★）：right 【outer】</li>
<li>全外：full 【outer】</li>
</ul>
<p>③ 交叉连接：cross</p>
<p><strong>1） 内连接</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">from 表1 别名</span><br><span class="line">inner join 表2 别名</span><br><span class="line">on 连接条件</span><br></pre></td></tr></table></figure>

<p><strong>分类</strong></p>
<p>① 等值连接<br>② 非等值连接<br>③ 自连接</p>
<p>特点：<br>① 添加排序、分组、筛选<br>② inner可以省略<br>③ 筛选条件放在where后面，连接条件放在on后面，提高分离性，便于阅读<br>④ inner join连接和sql92语法中的等值连接效果是一样的，都是查询多表的交集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line"># 1 等值连接</span><br><span class="line"># 案例1：查询员工名、部门名</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  department_name </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  INNER JOIN departments d </span><br><span class="line">    ON e.`department_id` = d.`department_id` ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询名字中包含e的员工名和工种名（添加筛选）</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  job_title </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  INNER JOIN jobs j </span><br><span class="line">    ON e.`job_id` = j.`job_id` </span><br><span class="line">WHERE last_name LIKE &#x27;%e%&#x27; ;</span><br><span class="line"></span><br><span class="line"># 案例3：查询部门个数&gt;3的城市名和部门个数，（添加分组+筛选）</span><br><span class="line">SELECT </span><br><span class="line">  city,</span><br><span class="line">  COUNT(*) 个数</span><br><span class="line">FROM</span><br><span class="line">  locations l </span><br><span class="line">  INNER JOIN departments d </span><br><span class="line">    ON l.`location_id` = d.`location_id` </span><br><span class="line">GROUP BY city </span><br><span class="line">HAVING COUNT(*) &gt; 3 ;</span><br><span class="line"></span><br><span class="line"># 案例4：查询哪个部门的员工个数&gt;3的部门名和员工个数，并按个数降序（添加排序）</span><br><span class="line">SELECT </span><br><span class="line">  department_name,</span><br><span class="line">  COUNT(*) 个数</span><br><span class="line">FROM</span><br><span class="line">  departments d </span><br><span class="line">  INNER JOIN employees e </span><br><span class="line">    ON d.`department_id` = e.`department_id` </span><br><span class="line">GROUP BY department_name </span><br><span class="line">HAVING COUNT(*) &gt; 3 </span><br><span class="line">ORDER BY COUNT(*) DESC ;</span><br><span class="line"></span><br><span class="line"># 案例5：查询员工名、部门名、工种名，并按部门名降序（添加三表连接）</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  department_name,</span><br><span class="line">  job_title </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  INNER JOIN departments d </span><br><span class="line">    ON e.`department_id` = d.`department_id` </span><br><span class="line">  INNER JOIN jobs j </span><br><span class="line">    ON e.`job_id` = j.`job_id` </span><br><span class="line">ORDER BY department_name DESC ;</span><br><span class="line"></span><br><span class="line"># 2 非等值连接</span><br><span class="line"># 案例1：查询员工的工资级别</span><br><span class="line">SELECT </span><br><span class="line">  salary,</span><br><span class="line">  grade_level </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  JOIN job_grades g </span><br><span class="line">    ON e.`salary` BETWEEN g.`lowest_sal` </span><br><span class="line">    AND g.`highest_sal` ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询工资级别的个数&gt;20的个数，并且按工资级别降序</span><br><span class="line">SELECT </span><br><span class="line">  grade_level,</span><br><span class="line">  COUNT(*) </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  JOIN job_grades g </span><br><span class="line">    ON e.`salary` BETWEEN g.`lowest_sal` </span><br><span class="line">    AND g.`highest_sal` </span><br><span class="line">GROUP BY grade_level </span><br><span class="line">HAVING COUNT(*) &gt; 20 </span><br><span class="line">ORDER BY grade_level DESC ;</span><br><span class="line"></span><br><span class="line"># 3 自连接</span><br><span class="line"># 案例1：查询员工的名字、上级的名字</span><br><span class="line">SELECT </span><br><span class="line">  e.last_name 员工,</span><br><span class="line">  m.last_name 上级 </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  JOIN employees m </span><br><span class="line">    ON e.`manager_id` = m.`employee_id` ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询姓名中包含字符k的员工的名字、上级的名字</span><br><span class="line">SELECT </span><br><span class="line">  e.last_name 员工,</span><br><span class="line">  m.last_name 上级 </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  JOIN employees m </span><br><span class="line">    ON e.`manager_id` = m.`employee_id` </span><br><span class="line">WHERE e.`last_name` LIKE &#x27;%k%&#x27; ;</span><br></pre></td></tr></table></figure>

<p><strong>2）外连接</strong></p>
<p> <strong>应用场景</strong>：用于查询一个表中有，另一个表没有的记录</p>
<p> <strong>特点</strong><br>① 外连接的查询结果为主表中的所有记录，<br>    如果从表中有和它匹配的，则显示匹配的值；<br>    如果从表中没有和它匹配的，则显示null；<br>    外连接查询结果 &#x3D; 内连接结果 + 主表中有而从表没有的记录</p>
<p>② 左外连接 ，left join 左边的是主表；<br>    右外连接，right join 右边的是主表</p>
<p>③ 左外和右外交换两个表的顺序，可以实现同样的效果 </p>
<p>④ 全外连接 &#x3D; 内连接的结果 + 表1中有但表2没有的 + 表2中有但表1没有的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"># 引入：查询男朋友不在男神表的女神名</span><br><span class="line">USE girls;</span><br><span class="line">SELECT * FROM beauty;</span><br><span class="line">SELECT * FROM boys;</span><br><span class="line"></span><br><span class="line"># 左外连接</span><br><span class="line">SELECT </span><br><span class="line">  b.name </span><br><span class="line">FROM</span><br><span class="line">  beauty b </span><br><span class="line">  LEFT OUTER JOIN boys bo </span><br><span class="line">    ON b.`boyfriend_id` = bo.`id` </span><br><span class="line">WHERE bo.`id` IS NULL ;</span><br><span class="line"></span><br><span class="line"># 右外连接</span><br><span class="line">SELECT </span><br><span class="line">  b.name </span><br><span class="line">FROM</span><br><span class="line">  boys bo </span><br><span class="line">  RIGHT OUTER JOIN beauty b </span><br><span class="line">    ON b.`boyfriend_id` = bo.`id` </span><br><span class="line">WHERE bo.`id` IS NULL ;</span><br><span class="line"></span><br><span class="line"># 案例1：查询哪个部门没有员工</span><br><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line"># 左外</span><br><span class="line">SELECT </span><br><span class="line">  d.*,</span><br><span class="line">  e.employee_id </span><br><span class="line">FROM</span><br><span class="line">  departments d </span><br><span class="line">  LEFT OUTER JOIN employees e </span><br><span class="line">    ON d.`department_id` = e.`department_id` </span><br><span class="line">WHERE employee_id IS NULL ;</span><br><span class="line"></span><br><span class="line"># 右外</span><br><span class="line">SELECT </span><br><span class="line">  d.*,</span><br><span class="line">  e.employee_id </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  RIGHT </span><br><span class="line">  OUTER JOIN departments d </span><br><span class="line">    ON d.`department_id` = e.`department_id` </span><br><span class="line">WHERE e.`employee_id` IS NULL ;</span><br><span class="line"></span><br><span class="line"># 全外</span><br><span class="line">USE girls ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  b.*,</span><br><span class="line">  bo.* </span><br><span class="line">FROM</span><br><span class="line">  beauty b FULL </span><br><span class="line">  OUTER JOIN boys bo </span><br><span class="line">    ON b.`boyfriend_id` = bo.id ;</span><br><span class="line"># MySQL不支持全外连接</span><br></pre></td></tr></table></figure>

<p><strong>3）交叉连接</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">  b.*,</span><br><span class="line">  bo.* </span><br><span class="line">FROM</span><br><span class="line">  beauty b </span><br><span class="line">  CROSS JOIN boys bo ;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>sql92 vs sql99</strong><br>功能：sql99支持的较多<br>可读性：sql99实现连接条件和筛选条件的分离，可读性较高</p>
</blockquote>
<h3 id="2-6-子查询"><a href="#2-6-子查询" class="headerlink" title="2.6 子查询"></a>2.6 子查询</h3><h4 id="2-6-1-含义"><a href="#2-6-1-含义" class="headerlink" title="2.6.1 含义"></a>2.6.1 含义</h4><p>出现在其他语句中的select语句，称为 子查询 或 内查询<br>外部的查询语句，称为 主查询 或 外查询</p>
<h4 id="2-6-2-分类"><a href="#2-6-2-分类" class="headerlink" title="2.6.2 分类"></a>2.6.2 分类</h4><p>① 按子查询出现的位置：</p>
<ul>
<li>select后面：<br>仅仅支持标量子查询</li>
<li>from后面：<br>支持表子查询</li>
<li>where 或 having后面：★<br>标量子查询（单行） √<br>    列子查询（多行） √<br>    行子查询</li>
<li>exists后面（相关子查询）：<br>表子查询</li>
</ul>
<p>②  按结果集的行列数不同：</p>
<ul>
<li>标量子查询（结果集中只有一行一列）</li>
<li>列子查询（结果集有一列多行）</li>
<li>行子查询（结果集有一行多列）</li>
<li>表子查询（结果集一般为多行多列）</li>
</ul>
<h4 id="2-6-3-where-或-having-后面"><a href="#2-6-3-where-或-having-后面" class="headerlink" title="2.6.3 where 或 having 后面"></a>2.6.3 where 或 having 后面</h4><p><strong>特点</strong><br>① 子查询放在小括号内<br>② 子查询一般放在条件的右侧<br>③ 标量子查询，一般搭配着<strong>单行操作符</strong>使用；<br>     列子查询，一般搭配着<strong>多行操作符</strong>使用</p>
<blockquote>
<p><strong>单行操作符</strong>：&gt; 、&lt; 、&gt;&#x3D;、 &lt;&#x3D; 、&#x3D; 、&lt;&gt;</p>
<p><strong>多行操作符</strong>：in、any&#x2F;some、all</p>
</blockquote>
<p>④ 子查询的执行优先于主查询执行，主查询的条件用到了子查询的结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">1、标量子查询（单行子查询）</span><br><span class="line">2、列子查询（多行子查询）</span><br><span class="line"></span><br><span class="line">3、行子查询（多列多行）</span><br><span class="line">*/</span><br><span class="line"># 1 标量子查询★</span><br><span class="line"># 案例1：谁的工资比 Abel 高?</span><br><span class="line"># ① 查询Abel的工资</span><br><span class="line">SELECT </span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE last_name = &#x27;Abel&#x27; ;</span><br><span class="line"></span><br><span class="line"># ② 查询员工的信息，满足 salary&gt;① 结果</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &gt; </span><br><span class="line">  (SELECT </span><br><span class="line">    salary </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE last_name = &#x27;Abel&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 案例2：返回job_id与141号员工相同，salary比143号员工多的员工 姓名，job_id 和工资</span><br><span class="line"># ① 查询141号员工的job_id</span><br><span class="line">SELECT </span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE employee_id = 141 ;</span><br><span class="line"></span><br><span class="line"># ② 查询143号员工的salary</span><br><span class="line">SELECT </span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE employee_id = 143 ;</span><br><span class="line"></span><br><span class="line"># ③ 查询员工的姓名，job_id 和工资，要求job_id=①并且salary&gt;②</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  job_id,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE job_id = </span><br><span class="line">  (SELECT </span><br><span class="line">    job_id </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE employee_id = 141) </span><br><span class="line">  AND salary &gt; </span><br><span class="line">  (SELECT </span><br><span class="line">    salary </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE employee_id = 143) ;</span><br><span class="line"></span><br><span class="line"># 案例3：返回公司工资最少的员工的last_name,job_id和salary</span><br><span class="line"># ① 查询公司的 最低工资</span><br><span class="line">SELECT MIN(salary)</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line"># ② 查询last_name,job_id和salary，要求salary=①</span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  job_id,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary = </span><br><span class="line">  (SELECT </span><br><span class="line">    MIN(salary) </span><br><span class="line">  FROM</span><br><span class="line">    employees) ;</span><br><span class="line"></span><br><span class="line"># 案例4：查询最低工资大于50号部门最低工资的部门id和其最低工资</span><br><span class="line"># ① 查询50号部门的最低工资</span><br><span class="line">SELECT </span><br><span class="line">  MIN(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE department_id = 50 ;</span><br><span class="line"></span><br><span class="line"># ② 查询每个部门的最低工资</span><br><span class="line">SELECT </span><br><span class="line">  MIN(salary),</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY department_id ;</span><br><span class="line"></span><br><span class="line">#③ 在②基础上筛选，满足min(salary)&gt;①</span><br><span class="line">SELECT </span><br><span class="line">  MIN(salary),</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY department_id </span><br><span class="line">HAVING MIN(salary) &gt; </span><br><span class="line">  (SELECT </span><br><span class="line">    MIN(salary) </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE department_id = 50) ;</span><br><span class="line"></span><br><span class="line"># 非法使用标量子查询</span><br><span class="line">SELECT </span><br><span class="line">  MIN(salary),</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY department_id </span><br><span class="line">HAVING MIN(salary) &gt; </span><br><span class="line">  (SELECT </span><br><span class="line">    MIN(salary) #    salary </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE department_id = 50) ;</span><br><span class="line">#  WHERE department_id = 250) ;</span><br><span class="line"></span><br><span class="line"># 2 列子查询（多行子查询）</span><br><span class="line"># 案例1：返回location_id是1400或1700的部门中的所有员工姓名</span><br><span class="line"># ① 查询location_id是1400或1700的部门编号</span><br><span class="line">SELECT DISTINCT </span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  departments </span><br><span class="line">WHERE location_id IN (1400, 1700) ;</span><br><span class="line"></span><br><span class="line"># ② 查询员工姓名，要求部门号是①列表中的某一个</span><br><span class="line"> </span><br><span class="line">SELECT </span><br><span class="line">  last_name </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE department_id IN </span><br><span class="line">  (SELECT DISTINCT </span><br><span class="line">    department_id </span><br><span class="line">  FROM</span><br><span class="line">    departments </span><br><span class="line">  WHERE location_id IN (1400, 1700)</span><br><span class="line"></span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line"># 案例2：返回其它工种中比job_id为‘IT_PROG’工种任一工资低的员工的员工号、姓名、job_id 以及salary</span><br><span class="line"># ① 查询job_id为‘IT_PROG’部门任一工资</span><br><span class="line">SELECT DISTINCT </span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE job_id = &#x27;IT_PROG&#x27; ;</span><br><span class="line"></span><br><span class="line"># ② 查询员工号、姓名、job_id 以及salary，salary&lt;(①)的任意一个</span><br><span class="line">SELECT </span><br><span class="line">  employee_id,</span><br><span class="line">  last_name,</span><br><span class="line">  job_id,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &lt; ANY </span><br><span class="line">  (SELECT DISTINCT </span><br><span class="line">    salary </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE job_id = &#x27;IT_PROG&#x27;) </span><br><span class="line">  AND job_id &lt;&gt; &#x27;IT_PROG&#x27; ;</span><br><span class="line"></span><br><span class="line"># 或</span><br><span class="line">SELECT </span><br><span class="line">  employee_id,</span><br><span class="line">  last_name,</span><br><span class="line">  job_id,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &lt; </span><br><span class="line">  (SELECT DISTINCT </span><br><span class="line">    MAX(salary) </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE job_id = &#x27;IT_PROG&#x27;) </span><br><span class="line">  AND job_id &lt;&gt; &#x27;IT_PROG&#x27; ;</span><br><span class="line"></span><br><span class="line"># 案例3：返回其它部门中比job_id为‘IT_PROG’部门所有工资都低的员工的员工号、姓名、job_id 以及salary</span><br><span class="line">SELECT </span><br><span class="line">  employee_id,</span><br><span class="line">  last_name,</span><br><span class="line">  job_id,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &lt; ALL </span><br><span class="line">  (SELECT DISTINCT </span><br><span class="line">    salary </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE job_id = &#x27;IT_PROG&#x27;) </span><br><span class="line">  AND job_id &lt;&gt; &#x27;IT_PROG&#x27; ;</span><br><span class="line"></span><br><span class="line"># 或</span><br><span class="line">SELECT </span><br><span class="line">  employee_id,</span><br><span class="line">  last_name,</span><br><span class="line">  job_id,</span><br><span class="line">  salary </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE salary &lt; </span><br><span class="line">  (SELECT DISTINCT </span><br><span class="line">    MIN(salary) </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE job_id = &#x27;IT_PROG&#x27;) </span><br><span class="line">  AND job_id &lt;&gt; &#x27;IT_PROG&#x27; ;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"># 3 行子查询（结果集一行多列或多行多列）</span><br><span class="line"># 案例：查询员工编号最小并且工资最高的员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE (employee_id, salary) = </span><br><span class="line">  (SELECT </span><br><span class="line">    MIN(employee_id),</span><br><span class="line">    MAX(salary) </span><br><span class="line">  FROM</span><br><span class="line">    employees) ;</span><br><span class="line"></span><br><span class="line"># 用前面的知识</span><br><span class="line"># ① 查询最小的员工编号</span><br><span class="line">SELECT </span><br><span class="line">  MIN(employee_id) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># ② 查询最高工资</span><br><span class="line">SELECT </span><br><span class="line">  MAX(salary) </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># ③ 查询员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE employee_id = </span><br><span class="line">  (SELECT </span><br><span class="line">    MIN(employee_id) </span><br><span class="line">  FROM</span><br><span class="line">    employees) </span><br><span class="line">  AND salary = </span><br><span class="line">  (SELECT </span><br><span class="line">    MAX(salary) </span><br><span class="line">  FROM</span><br><span class="line">    employees) ;</span><br></pre></td></tr></table></figure>

<h4 id="2-6-4-select后面"><a href="#2-6-4-select后面" class="headerlink" title="2.6.4 select后面"></a>2.6.4 select后面</h4><blockquote>
<p>仅仅支持标量子查询</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：查询每个部门的员工个数</span><br><span class="line">SELECT </span><br><span class="line">  d.*,</span><br><span class="line">  (SELECT </span><br><span class="line">    COUNT(*) </span><br><span class="line">  FROM</span><br><span class="line">    employees e </span><br><span class="line">  WHERE e.department_id = d.`department_id`) 个数</span><br><span class="line">FROM</span><br><span class="line">  departments d ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询员工号=102的部门名</span><br><span class="line">SELECT </span><br><span class="line">  (SELECT </span><br><span class="line">    department_name</span><br><span class="line">  FROM</span><br><span class="line">    departments d </span><br><span class="line">    INNER JOIN employees e </span><br><span class="line">      ON d.department_id = e.department_id </span><br><span class="line">  WHERE e.employee_id = 102) 部门名 ;</span><br></pre></td></tr></table></figure>

<h4 id="2-6-5-from后面"><a href="#2-6-5-from后面" class="headerlink" title="2.6.5 from后面"></a>2.6.5 from后面</h4><blockquote>
<p>将子查询结果充当一张表，要求必须起别名</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 案例：查询每个部门的平均工资的工资等级</span><br><span class="line"># ① 查询每个部门的平均工资</span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary),</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY department_id ;</span><br><span class="line"></span><br><span class="line"># ② 连接①的结果集和job_grades表，筛选条件平均工资 between lowest_sal and highest_sal</span><br><span class="line">SELECT </span><br><span class="line">  ag_dep.*,</span><br><span class="line">  g.`grade_level` </span><br><span class="line">FROM</span><br><span class="line">  (SELECT </span><br><span class="line">    AVG(salary) ag,</span><br><span class="line">    department_id </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  GROUP BY department_id) ag_dep </span><br><span class="line">  INNER JOIN job_grades g </span><br><span class="line">    ON ag_dep.ag BETWEEN lowest_sal </span><br><span class="line">    AND highest_sal ;</span><br></pre></td></tr></table></figure>

<h4 id="2-6-6-exists后面（相关子查询）"><a href="#2-6-6-exists后面（相关子查询）" class="headerlink" title="2.6.6 exists后面（相关子查询）"></a>2.6.6 exists后面（相关子查询）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">语法：</span><br><span class="line">	exists(完整的查询语句)</span><br><span class="line">结果：</span><br><span class="line">	1或0</span><br><span class="line">	</span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">  EXISTS </span><br><span class="line">  (SELECT </span><br><span class="line">    employee_id </span><br><span class="line">  FROM</span><br><span class="line">    employees </span><br><span class="line">  WHERE salary = 300000) ;</span><br><span class="line"></span><br><span class="line"># 案例1：查询有员工的部门名</span><br><span class="line"># in</span><br><span class="line">SELECT </span><br><span class="line">  department_name </span><br><span class="line">FROM</span><br><span class="line">  departments d </span><br><span class="line">WHERE d.`department_id` IN </span><br><span class="line">  (SELECT </span><br><span class="line">    department_id </span><br><span class="line">  FROM</span><br><span class="line">    employees) ;</span><br><span class="line"></span><br><span class="line"># exists</span><br><span class="line">SELECT </span><br><span class="line">  department_name </span><br><span class="line">FROM</span><br><span class="line">  departments d </span><br><span class="line">WHERE EXISTS </span><br><span class="line">  (SELECT </span><br><span class="line">    * </span><br><span class="line">  FROM</span><br><span class="line">    employees e </span><br><span class="line">  WHERE d.`department_id` = e.`department_id`) ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line"></span><br><span class="line"># 案例2：查询没有女朋友的男神信息</span><br><span class="line"># in</span><br><span class="line">  SELECT </span><br><span class="line">    bo.* </span><br><span class="line">  FROM</span><br><span class="line">    boys bo </span><br><span class="line">  WHERE bo.id NOT IN </span><br><span class="line">    (SELECT </span><br><span class="line">      boyfriend_id </span><br><span class="line">    FROM</span><br><span class="line">      beauty) ;</span><br><span class="line"></span><br><span class="line"># exists</span><br><span class="line">SELECT </span><br><span class="line">  bo.* </span><br><span class="line">FROM</span><br><span class="line">  boys bo </span><br><span class="line">WHERE NOT EXISTS </span><br><span class="line">  (SELECT </span><br><span class="line">    boyfriend_id </span><br><span class="line">  FROM</span><br><span class="line">    beauty b </span><br><span class="line">  WHERE bo.`id` = b.`boyfriend_id`) ;</span><br></pre></td></tr></table></figure>

<h3 id="2-7-分页查询"><a href="#2-7-分页查询" class="headerlink" title="2.7 分页查询"></a>2.7 分页查询</h3><h4 id="2-7-1-应用场景"><a href="#2-7-1-应用场景" class="headerlink" title="2.7.1 应用场景"></a>2.7.1 应用场景</h4><p>当要查询的条目数太多，一页显示不全,需要分页提交sql请求</p>
<h4 id="2-7-2-语法"><a href="#2-7-2-语法" class="headerlink" title="2.7.2 语法"></a>2.7.2 语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">from 表1</span><br><span class="line">【join type join 表2</span><br><span class="line">on 连接条件</span><br><span class="line">where 筛选条件</span><br><span class="line">group by 分组字段</span><br><span class="line">having 分组后的筛选</span><br><span class="line">order by 排序的字段】</span><br><span class="line">limit offset, size;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>offset：要显示条目的起始索引（起始索引从0开始）<br>size：要显示的条目个数</p>
</blockquote>
<h4 id="2-7-3-特点"><a href="#2-7-3-特点" class="headerlink" title="2.7.3 特点"></a>2.7.3 特点</h4><p>① limit语句放在查询语句的最后<br>② 公式：<code>limit (page-1)*size,size;</code></p>
<blockquote>
<p>要显示的页数 page，没有条目数 size</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">USE myemployees;</span><br><span class="line"># 案例1：查询前五条员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">LIMIT 0, 5 ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">LIMIT 5 ;</span><br><span class="line"></span><br><span class="line"># 案例2：查询第11-25条员工信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">LIMIT 11, 15 ;</span><br><span class="line"></span><br><span class="line"># 案例3：有奖金的员工信息，并且工资较高的前10名显示出来</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE commission_pct IS NOT NULL </span><br><span class="line">ORDER BY salary DESC </span><br><span class="line">LIMIT 10 ;</span><br></pre></td></tr></table></figure>

<h3 id="2-8-联合查询"><a href="#2-8-联合查询" class="headerlink" title="2.8 联合查询"></a>2.8 联合查询</h3><h4 id="2-8-1-应用场景"><a href="#2-8-1-应用场景" class="headerlink" title="2.8.1 应用场景"></a>2.8.1 应用场景</h4><p>要查询的结果来自于多个表，且多个表没有直接的连接关系，但查询的信息一致时</p>
<h4 id="2-8-2-语法"><a href="#2-8-2-语法" class="headerlink" title="2.8.2 语法"></a>2.8.2 语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查询语句1</span><br><span class="line">union</span><br><span class="line">查询语句2</span><br><span class="line">union</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><code>union</code>: 联合、合并。将多条查询语句的结果合并成一个结果</p>
<h4 id="2-8-3-特点★"><a href="#2-8-3-特点★" class="headerlink" title="2.8.3 特点★"></a>2.8.3 特点★</h4><p>① 要求多条查询语句的查询列数是一致的！</p>
<p>② 要求多条查询语句的查询的每一列的类型和顺序最好一致</p>
<p>③ union关键字默认去重，如果使用union all 可以包含重复项</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">USE myemployees;</span><br><span class="line"># 引入：查询部门编号&gt;90 或 邮箱包含a的员工信息</span><br><span class="line"> </span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE email LIKE &#x27;%a%&#x27; </span><br><span class="line">  OR department_id &gt; 90 ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE email LIKE &#x27;%a%&#x27; </span><br><span class="line">UNION</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">WHERE department_id &gt; 90 ;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="第三章-DML语言"><a href="#第三章-DML语言" class="headerlink" title="第三章 DML语言"></a>第三章 DML语言</h2><p>DML（Data Manipulation Language）：数据操作语言，用来定义数据库记录（数据）</p>
<blockquote>
<p>插入：insert<br>修改：update<br>删除：delete</p>
</blockquote>
<h3 id="3-1-插入语言"><a href="#3-1-插入语言" class="headerlink" title="3.1 插入语言"></a>3.1 插入语言</h3><h4 id="3-1-1-方式一"><a href="#3-1-1-方式一" class="headerlink" title="3.1.1 方式一"></a>3.1.1 方式一</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名（列名，……） value（值1，……）</span><br></pre></td></tr></table></figure>

<h4 id="3-1-2-方式二"><a href="#3-1-2-方式二" class="headerlink" title="3.1.2 方式二"></a>3.1.2 方式二</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名</span><br><span class="line">set 列名 = 值, 列名 = 值, ...</span><br></pre></td></tr></table></figure>

<h4 id="3-1-3-两种方式对比"><a href="#3-1-3-两种方式对比" class="headerlink" title="3.1.3 两种方式对比"></a>3.1.3 两种方式对比</h4><p>① 方式一支持插入多行，方式二不支持</p>
<p>② 方式一支持子查询，方式二不支持</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"># 1.插入的值的类型要与列的类型一致或兼容</span><br><span class="line"></span><br><span class="line">USE girls;</span><br><span class="line">INSERT INTO beauty(id, NAME, sex, borndate, phone, photo, boyfriend_id)</span><br><span class="line">VALUE(13, &#x27;王小虎&#x27;, &#x27;男&#x27;, &#x27;1990-4-23&#x27;, &#x27;18288668899&#x27;, NULL, 2);</span><br><span class="line"></span><br><span class="line">SELECT * FROM beauty;</span><br><span class="line"></span><br><span class="line"># 2.不可以为null的列必须插入值，可以为null的列如何插入值？</span><br><span class="line"># 方式一：null</span><br><span class="line">INSERT INTO beauty (</span><br><span class="line">  id,</span><br><span class="line">  NAME,</span><br><span class="line">  sex,</span><br><span class="line">  borndate,</span><br><span class="line">  phone,</span><br><span class="line">  photo,</span><br><span class="line">  boyfriend_id</span><br><span class="line">) VALUE (</span><br><span class="line">  13,</span><br><span class="line">  &#x27;王小虎&#x27;,</span><br><span class="line">  &#x27;男&#x27;,</span><br><span class="line">  &#x27;1990-4-23&#x27;,</span><br><span class="line">  &#x27;18288668899&#x27;,</span><br><span class="line">  NULL,</span><br><span class="line">  2</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line"># 方式二：省略</span><br><span class="line">INSERT INTO beauty (</span><br><span class="line">  id,</span><br><span class="line">  NAME,</span><br><span class="line">  sex,</span><br><span class="line">  borndate,</span><br><span class="line">  phone,</span><br><span class="line">  boyfriend_id</span><br><span class="line">) VALUE (</span><br><span class="line">  14,</span><br><span class="line">  &#x27;金星&#x27;,</span><br><span class="line">  &#x27;女&#x27;,</span><br><span class="line">  &#x27;1990-4-23&#x27;,</span><br><span class="line">  &#x27;18288778899&#x27;,</span><br><span class="line">  2</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO beauty (id, NAME, sex, phone) VALUE (15, &#x27;娜扎&#x27;, &#x27;女&#x27;, &#x27;18288770099&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 3.列的顺序能否调换？ # 能，但必须对应</span><br><span class="line">INSERT INTO beauty (NAME, id, sex, phone) VALUE (&#x27;蒋欣&#x27;, 16, &#x27;女&#x27;, &#x27;18266778899&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 4.列数和值的个数必须一致</span><br><span class="line">INSERT INTO beauty (NAME, id, sex, phone) VALUE (&#x27;关晓彤&#x27;, 17, &#x27;女&#x27;, &#x27;18288778899&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 5.可以省略列名，默认所有列，而且列的顺序和表中列的顺序一致</span><br><span class="line">INSERT INTO beauty VALUE (</span><br><span class="line">  18,</span><br><span class="line">  &#x27;张飞&#x27;,</span><br><span class="line">  &#x27;男&#x27;,</span><br><span class="line">  NULL,</span><br><span class="line">  &#x27;110&#x27;,</span><br><span class="line">  NULL,</span><br><span class="line">  NULL</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line"># 方式二：</span><br><span class="line">/*</span><br><span class="line">语法：</span><br><span class="line">insert into 表名</span><br><span class="line">set 列名 = 值, 列名 = 值, ...</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">INSERT INTO beauty SET id = 19,</span><br><span class="line">NAME = &#x27;刘涛&#x27;,</span><br><span class="line">phone = &#x27;199&#x27; ;</span><br><span class="line"></span><br><span class="line"># 两种方式大pk ★</span><br><span class="line"># 1、方式一支持插入多行,方式二不支持</span><br><span class="line">INSERT INTO beauty </span><br><span class="line">VALUES</span><br><span class="line">  (</span><br><span class="line">    23,</span><br><span class="line">    &#x27;唐艺昕1&#x27;,</span><br><span class="line">    &#x27;女&#x27;,</span><br><span class="line">    &#x27;1990-4-23&#x27;,</span><br><span class="line">    &#x27;1898888888&#x27;,</span><br><span class="line">    NULL,</span><br><span class="line">    2</span><br><span class="line">  ),</span><br><span class="line">  (</span><br><span class="line">    24,</span><br><span class="line">    &#x27;唐艺昕2&#x27;,</span><br><span class="line">    &#x27;女&#x27;,</span><br><span class="line">    &#x27;1990-4-23&#x27;,</span><br><span class="line">    &#x27;1898888888&#x27;,</span><br><span class="line">    NULL,</span><br><span class="line">    2</span><br><span class="line">  ),</span><br><span class="line">  (</span><br><span class="line">    25,</span><br><span class="line">    &#x27;唐艺昕3&#x27;,</span><br><span class="line">    &#x27;女&#x27;,</span><br><span class="line">    &#x27;1990-4-23&#x27;,</span><br><span class="line">    &#x27;1898888888&#x27;,</span><br><span class="line">    NULL,</span><br><span class="line">    2</span><br><span class="line">  ) ;</span><br><span class="line"></span><br><span class="line"># 2、方式一支持子查询，方式二不支持</span><br><span class="line">INSERT INTO beauty (id, NAME, phone) </span><br><span class="line">SELECT </span><br><span class="line">  26,</span><br><span class="line">  &#x27;宋茜&#x27;,</span><br><span class="line">  &#x27;11809866&#x27; ;</span><br><span class="line"></span><br><span class="line">INSERT INTO beauty (id, NAME, phone) </span><br><span class="line">SELECT </span><br><span class="line">  id,</span><br><span class="line">  boyname,</span><br><span class="line">  &#x27;1234567&#x27; </span><br><span class="line">FROM</span><br><span class="line">  boys </span><br><span class="line">WHERE id &lt; 3 ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  beauty ;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-修改语句"><a href="#3-2-修改语句" class="headerlink" title="3.2 修改语句"></a>3.2 修改语句</h3><h4 id="3-2-1-修改单表的记录★"><a href="#3-2-1-修改单表的记录★" class="headerlink" title="3.2.1 修改单表的记录★"></a>3.2.1 修改单表的记录★</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update 表名</span><br><span class="line">set 列=新值,列=新值,...</span><br><span class="line">where 筛选条件;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2-修改多表的记录【补充】"><a href="#3-2-2-修改多表的记录【补充】" class="headerlink" title="3.2.2 修改多表的记录【补充】"></a>3.2.2 修改多表的记录【补充】</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># sql92语法：</span><br><span class="line">update 表1 别名1,表2 别名2</span><br><span class="line">set 列=值,...</span><br><span class="line">where 连接条件</span><br><span class="line">and 筛选条件;</span><br><span class="line"></span><br><span class="line"># sql99语法：</span><br><span class="line">update 表1 别名1</span><br><span class="line">inner|left|right join 表2 别名2</span><br><span class="line">on 连接条件</span><br><span class="line">set 列=值,...</span><br><span class="line">where 筛选条件;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># 1.修改单表的记录</span><br><span class="line"># 案例1：修改beauty表中姓唐的女神的电话为13899888899</span><br><span class="line">UPDATE </span><br><span class="line">  beauty </span><br><span class="line">SET</span><br><span class="line">  phone = &#x27;13899888899&#x27; </span><br><span class="line">WHERE NAME LIKE &#x27;唐%&#x27; ;</span><br><span class="line"></span><br><span class="line"># 案例2：修改boys表中id好为2的名称为张飞，魅力值 10</span><br><span class="line">UPDATE </span><br><span class="line">  boys </span><br><span class="line">SET</span><br><span class="line">  boyname = &#x27;张飞&#x27;,</span><br><span class="line">  usercp = 10 </span><br><span class="line">WHERE id = 2 ;</span><br><span class="line"></span><br><span class="line"># 2.修改多表的记录</span><br><span class="line"># 案例 1：修改张无忌的女朋友的手机号为114</span><br><span class="line">UPDATE </span><br><span class="line">  boys bo </span><br><span class="line">  INNER JOIN beauty b </span><br><span class="line">    ON bo.`id` = b.`id` SET b.`phone` = &#x27;120&#x27;,</span><br><span class="line">  bo.`userCP` = 120 </span><br><span class="line">WHERE bo.`boyName` = &#x27;张无忌&#x27; ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例2：修改没有男朋友的女神的男朋友编号都为2号</span><br><span class="line">UPDATE </span><br><span class="line">  boys bo </span><br><span class="line">  RIGHT JOIN beauty b </span><br><span class="line">    ON bo.`id` = b.`boyfriend_id` SET b.`boyfriend_id` = 2 </span><br><span class="line">WHERE bo.`id` IS NULL ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  boys ;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-删除语句"><a href="#3-4-删除语句" class="headerlink" title="3.4 删除语句"></a>3.4 删除语句</h3><h4 id="3-4-1-方式一：delete"><a href="#3-4-1-方式一：delete" class="headerlink" title="3.4.1 方式一：delete"></a>3.4.1 方式一：delete</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 1 单表的删除【★】</span><br><span class="line">delete from 表名 where 筛选条件</span><br><span class="line"></span><br><span class="line"># 2 多表的删除【补充】</span><br><span class="line"># sql92语法：</span><br><span class="line">delete 表1的别名,表2的别名</span><br><span class="line">from 表1 别名,表2 别名</span><br><span class="line">where 连接条件</span><br><span class="line">and 筛选条件;</span><br><span class="line"></span><br><span class="line"># sql99语法：</span><br><span class="line">delete 表1的别名,表2的别名</span><br><span class="line">from 表1 别名</span><br><span class="line">inner|left|right join 表2 别名 on 连接条件</span><br><span class="line">where 筛选条件;</span><br></pre></td></tr></table></figure>

<h4 id="3-4-2-方式二：truncate"><a href="#3-4-2-方式二：truncate" class="headerlink" title="3.4.2 方式二：truncate"></a>3.4.2 方式二：truncate</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truncate table 表名;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>delete vs truncate【面试题★】</p>
<ol>
<li>delete 可以加where 条件，truncate不能加</li>
<li>truncate删除，效率高一丢丢</li>
<li>假如要删除的表中有自增长列，如果<br>用delete删除后，再插入数据，自增长列的值从断点开始，<br>  而truncate删除后，再插入数据，自增长列的值从1开始。</li>
<li>truncate删除没有返回值，delete删除有返回值</li>
<li>truncate删除不能回滚，delete删除可以回滚.</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"># 方式一：delete</span><br><span class="line"># 1.单表的删除</span><br><span class="line"># 案例1：删除手机号以9结尾的女神信息</span><br><span class="line">DELETE </span><br><span class="line">FROM</span><br><span class="line">  beauty </span><br><span class="line">WHERE phone LIKE &#x27;%9&#x27; ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  beauty ;</span><br><span class="line"></span><br><span class="line"># 2.多表的删除</span><br><span class="line"># 案例1：删除张无忌的女朋友的信息</span><br><span class="line">DELETE </span><br><span class="line">  b </span><br><span class="line">FROM</span><br><span class="line">  beauty b </span><br><span class="line">  INNER JOIN boys bo </span><br><span class="line">    ON b.`boyfriend_id` = bo.`id` </span><br><span class="line">WHERE bo.`boyName` = &#x27;张无忌&#x27; ;</span><br><span class="line"></span><br><span class="line"># 案例2：删除黄晓明的信息以及他女朋友的信息</span><br><span class="line">DELETE </span><br><span class="line">  b,</span><br><span class="line">  bo </span><br><span class="line">FROM</span><br><span class="line">  beauty b </span><br><span class="line">  INNER JOIN boys bo </span><br><span class="line">    ON b.`boyfriend_id` = bo.`id` </span><br><span class="line">WHERE bo.`boyName` = &#x27;黄晓明&#x27; ;</span><br><span class="line"></span><br><span class="line"># 方式二：truncate语句</span><br><span class="line"># 案例：将魅力值&gt;100的男神信息删除</span><br><span class="line">TRUNCATE TABLE boys ;</span><br><span class="line"># 删除整个表</span><br><span class="line"># delete pk truncate【面试题★】</span><br><span class="line">/*</span><br><span class="line">1.delete 可以加where 条件，truncate不能加</span><br><span class="line">2.truncate删除，效率高一丢丢</span><br><span class="line">3.假如要删除的表中有自增长列，</span><br><span class="line">	如果用delete删除后，再插入数据，自增长列的值从断点开始，</span><br><span class="line">	而truncate删除后，再插入数据，自增长列的值从1开始。</span><br><span class="line">4.truncate删除没有返回值，delete删除有返回值</span><br><span class="line">5.truncate删除不能回滚，delete删除可以回滚.</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  boys ;</span><br><span class="line"></span><br><span class="line">DELETE </span><br><span class="line">FROM</span><br><span class="line">  boys ;</span><br><span class="line"></span><br><span class="line">TRUNCATE TABLE boys ;</span><br><span class="line"></span><br><span class="line">INSERT INTO boys (boyname, usercp) </span><br><span class="line">VALUES</span><br><span class="line">  (&#x27;张飞&#x27;, 100),</span><br><span class="line">  (&#x27;刘备&#x27;, 100),</span><br><span class="line">  (&#x27;关云长&#x27;, 100) ;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="第四章-DDL语言"><a href="#第四章-DDL语言" class="headerlink" title="第四章 DDL语言"></a>第四章 DDL语言</h2><p>DDL（Data Definition Language）：数据定义语言，用来定义数据库对象：库、表、列等</p>
<h3 id="4-1-库的管理"><a href="#4-1-库的管理" class="headerlink" title="4.1 库的管理"></a>4.1 库的管理</h3><h4 id="4-1-1-库的创建"><a href="#4-1-1-库的创建" class="headerlink" title="4.1.1 库的创建"></a>4.1.1 库的创建</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database [if not exists] 库名;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 案例：创建库books</span><br><span class="line"></span><br><span class="line">CREATE DATABASE IF NOT EXISTS books ;</span><br></pre></td></tr></table></figure>

<h4 id="4-1-2-库的修改"><a href="#4-1-2-库的修改" class="headerlink" title="4.1.2 库的修改"></a>4.1.2 库的修改</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RENAME DATABASE books TO 新库名; # 不安全，弃用</span><br><span class="line"></span><br><span class="line"># 更改库的字符集</span><br><span class="line">ALTER DATABASE books </span><br><span class="line">  CHARACTER SET gbk ;</span><br></pre></td></tr></table></figure>

<h4 id="4-1-3-库的删除"><a href="#4-1-3-库的删除" class="headerlink" title="4.1.3 库的删除"></a>4.1.3 库的删除</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP DATABASE IF EXISTS 库名 ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 案例：删除库books</span><br><span class="line">DROP DATABASE IF EXISTS books ;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-表的管理"><a href="#4-2-表的管理" class="headerlink" title="4.2 表的管理"></a>4.2 表的管理</h3><h4 id="4-2-1-表的创建"><a href="#4-2-1-表的创建" class="headerlink" title="4.2.1 表的创建"></a>4.2.1 表的创建</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">	列名 列的类型【（长度）约束】,</span><br><span class="line">	列名 列的类型【（长度）约束】,</span><br><span class="line">	列名 列的类型【（长度）约束】,</span><br><span class="line">	...</span><br><span class="line">	列名 列的类型【（长度）约束】,</span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：创建表book</span><br><span class="line">CREATE TABLE book (</span><br><span class="line">  id INT,</span><br><span class="line">  # 编号</span><br><span class="line">  bName VARCHAR (20),</span><br><span class="line">  # 书名</span><br><span class="line">  price DOUBLE,</span><br><span class="line">  # 价格</span><br><span class="line">  authorId INT,</span><br><span class="line">  # 作者编号</span><br><span class="line">  publishDate DATETIME#出版日期</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line"># 案例2：创建表author</span><br><span class="line">CREATE TABLE IF NOT EXISTS author (</span><br><span class="line">  id INT,</span><br><span class="line">  au_name VARCHAR (20),</span><br><span class="line">  nation VARCHAR (10)</span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-2-表的修改"><a href="#4-2-2-表的修改" class="headerlink" title="4.2.2 表的修改"></a>4.2.2 表的修改</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add|drop|modify|change column 列名 【列类型 约束】;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># ① 修改列名</span><br><span class="line">ALTER TABLE book </span><br><span class="line">  CHANGE COLUMN publishdate pubDate DATETIME ;</span><br><span class="line"></span><br><span class="line"># ② 修改列的类型或约束</span><br><span class="line">ALTER TABLE book </span><br><span class="line">  MODIFY COLUMN pubdate TIMESTAMP ;</span><br><span class="line"></span><br><span class="line"># ③ 添加新列</span><br><span class="line">ALTER TABLE author </span><br><span class="line">  ADD COLUMN annual DOUBLE ;</span><br><span class="line"></span><br><span class="line"># ④ 删除列</span><br><span class="line">ALTER TABLE author </span><br><span class="line">  DROP COLUMN annual ;</span><br><span class="line"></span><br><span class="line"># ⑤ 修改表名</span><br><span class="line">ALTER TABLE author </span><br><span class="line">  RENAME TO book_author ;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-3-表的删除"><a href="#4-2-3-表的删除" class="headerlink" title="4.2.3 表的删除"></a>4.2.3 表的删除</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE 【IF EXISTS】 表名 ; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 删除表book_author</span><br><span class="line">DROP TABLE IF EXISTS book_author ;</span><br><span class="line"></span><br><span class="line">SHOW TABLES ;</span><br><span class="line"></span><br><span class="line"># 通用的写法：</span><br><span class="line">DROP DATABASE IF EXISTS 旧库名 ;</span><br><span class="line">CREATE DATABASE 新库名;</span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS 旧表名 ;</span><br><span class="line">CREATE TABLE 表名 ;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-4-表的复制"><a href="#4-2-4-表的复制" class="headerlink" title="4.2.4 表的复制"></a>4.2.4 表的复制</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO author </span><br><span class="line">VALUES</span><br><span class="line">  (1, &#x27;村上春树&#x27;, &#x27;日本&#x27;),</span><br><span class="line">  (2, &#x27;莫言&#x27;, &#x27;中国&#x27;),</span><br><span class="line">  (3, &#x27;冯唐&#x27;, &#x27;中国&#x27;),</span><br><span class="line">  (4, &#x27;金庸&#x27;, &#x27;中国&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 1、仅仅复制表的结构</span><br><span class="line">CREATE TABLE copy LIKE author;</span><br><span class="line"></span><br><span class="line"># 2、复制表的结构 + 数据</span><br><span class="line">CREATE TABLE copy1 </span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  author ;</span><br><span class="line">  </span><br><span class="line"># 3、只复制部分数据</span><br><span class="line">CREATE TABLE copy2 </span><br><span class="line">SELECT </span><br><span class="line">  id,</span><br><span class="line">  au_name </span><br><span class="line">FROM</span><br><span class="line">  author </span><br><span class="line">WHERE nation = &#x27;中国&#x27; ;</span><br><span class="line"></span><br><span class="line"># 4、仅仅复制某些字段</span><br><span class="line">CREATE TABLE copy3 </span><br><span class="line">SELECT </span><br><span class="line">  id,</span><br><span class="line">  au_name </span><br><span class="line">FROM</span><br><span class="line">  author </span><br><span class="line">WHERE 0;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-数据类型"><a href="#4-3-数据类型" class="headerlink" title="4.3 数据类型"></a>4.3 数据类型</h3><h4 id="4-3-1-分类"><a href="#4-3-1-分类" class="headerlink" title="4.3.1 分类"></a>4.3.1 分类</h4><p><strong>数值型</strong></p>
<ul>
<li>整型</li>
<li>小数：<ul>
<li>定点数</li>
<li>浮点数</li>
</ul>
</li>
</ul>
<p><strong>字符型</strong></p>
<ul>
<li>较短的文本：char、varchar</li>
<li>较长的文本：text、blob（较长的二进制数据）</li>
</ul>
<p><strong>日期型</strong></p>
<h4 id="4-3-2-整型"><a href="#4-3-2-整型" class="headerlink" title="4.3.2 整型"></a>4.3.2 整型</h4><p><strong>1）分类</strong></p>
<table>
<thead>
<tr>
<th align="center">tinyint</th>
<th align="center">smallint</th>
<th align="center">mediumint</th>
<th align="center">int&#x2F;integer</th>
<th align="center">bigint</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">4</td>
<td align="center">8</td>
</tr>
</tbody></table>
<p><strong>2）特点</strong></p>
<p>① 如果不设置无符号还是有符号，默认是有符号，如果想设置无符号，需要添加unsigned关键字</p>
<p>② 如果插入的数值超出了整型的范围，会报out of range异常，并且插入临界值</p>
<p>③ 如果不设置长度，会有默认的长度；长度代表显示的最大宽度，如果不够会用0在左边填充，但必须搭配zerofill使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 如何设置无符号和有符号</span><br><span class="line">DROP TABLE IF EXISTS tab_int ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_int (</span><br><span class="line">  t1 INT (7) ZEROFILL,</span><br><span class="line">  t2 INT (7) UNSIGNED ZEROFILL</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">DESC tab_int ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_int </span><br><span class="line">VALUES</span><br><span class="line">  (- 12345, 12345) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_int </span><br><span class="line">VALUES</span><br><span class="line">  (24545444, 12345) ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  tab_int ;</span><br></pre></td></tr></table></figure>

<h4 id="4-3-3-小数"><a href="#4-3-3-小数" class="headerlink" title="4.3.3 小数"></a>4.3.3 小数</h4><p><strong>1）分类</strong></p>
<p>① <strong>定点数</strong>：float(M,D)、double(M,D)</p>
<p>② <strong>浮点数</strong>：dec((M,D)、decimal(M,D)</p>
<p><strong>2）特点</strong></p>
<p>① M和D</p>
<p>M：整数部位 + 小数部位</p>
<p>D：小数部位</p>
<p>如果超过范围，则插入临界值</p>
<p>② M和D都可以省略</p>
<p>如果是decimal，则M默认为10，D默认为0</p>
<p>如果是float和double，则会根据插入的数值的精度来决定精度</p>
<p>③ 定点型的精度较高，如果要求插入数值的精度较高，如货币运算等，则考虑使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># M和D测试</span><br><span class="line">CREATE TABLE tab_float(</span><br><span class="line">f1 FLOAT(5,2),</span><br><span class="line">f2 DOUBLE(5,2),</span><br><span class="line">f3 DECIMAL(5,2)</span><br><span class="line">);</span><br><span class="line">SELECT * FROM tab_float VALUES(123.4, 123.4, 123.4);</span><br><span class="line">SELECT * FROM tab_float VALUES(123.45, 123.45, 123.45);</span><br><span class="line">SELECT * FROM tab_float VALUES(123.456, 123.456, 123.456);</span><br></pre></td></tr></table></figure>

<h4 id="4-3-4-字符型"><a href="#4-3-4-字符型" class="headerlink" title="4.3.4 字符型"></a>4.3.4 字符型</h4><p><strong>1）分类</strong></p>
<p>① 较短的文本：char、varchar</p>
<p>其他：binary 和 varbinary用于保存较短的二进制、enum用于保存枚举、set用于保存集合</p>
<p>② 较长的文本：text、blob（较大的二进制）</p>
<p><strong>2）特点</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>写法</th>
<th>M的意思</th>
<th>特点</th>
<th>空间的耗费</th>
<th>效率</th>
</tr>
</thead>
<tbody><tr>
<td>char</td>
<td>char(M)</td>
<td>最大的字符数，可以省略，默认为1</td>
<td>固定长度的字符</td>
<td>比较耗费</td>
<td>高</td>
</tr>
<tr>
<td>varchar</td>
<td>varchar(M)</td>
<td>最大的字符数，不可以省略</td>
<td>可变长度的字符</td>
<td>比较节省</td>
<td>低</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tab_char (c1 ENUM (&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;)) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;a&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;b&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;c&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;m&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;A&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_char;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_set (s1 SET (&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;)) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_set VALUES(&#x27;a&#x27;);</span><br><span class="line">INSERT INTO tab_set VALUES(&#x27;A,B&#x27;);</span><br><span class="line">INSERT INTO tab_set VALUES(&#x27;a,c,d&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_set;</span><br></pre></td></tr></table></figure>

<h4 id="4-3-5-日期型"><a href="#4-3-5-日期型" class="headerlink" title="4.3.5 日期型"></a>4.3.5 日期型</h4><p><strong>1）分类</strong></p>
<p>① date：只保存日期</p>
<p>② time：只保存时间</p>
<p>③ year：只保存年</p>
<p>④ datetime：保存日期 + 时间</p>
<p>⑤ timestamp：保存日期 + 时间</p>
<p><strong>2）特点</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">字节</th>
<th align="center">范围</th>
<th align="center">时区等的影响</th>
</tr>
</thead>
<tbody><tr>
<td align="center">datetime</td>
<td align="center">8</td>
<td align="center">1000——9999</td>
<td align="center">不受</td>
</tr>
<tr>
<td align="center">timestamp</td>
<td align="center">4</td>
<td align="center">1970-2038</td>
<td align="center">受</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tab_date (t1 DATETIME, t2 TIMESTAMP) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_date VALUES(NOW(),NOW());</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_date;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;time_zone&#x27;;</span><br><span class="line"></span><br><span class="line">SET time_zone=&#x27;+9:00&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-约束"><a href="#4-4-约束" class="headerlink" title="4.4 约束"></a>4.4 约束</h3><h4 id="4-4-1-含义"><a href="#4-4-1-含义" class="headerlink" title="4.4.1 含义"></a>4.4.1 含义</h4><p>一种限制，用于限制表中的数据，为了保证表中的数据的准确和可靠性</p>
<h4 id="4-4-2-分类"><a href="#4-4-2-分类" class="headerlink" title="4.4.2 分类"></a>4.4.2 分类</h4><p>六大约束：</p>
<p><strong>1）NOT NULL</strong></p>
<p>非空，用于保证该字段的值不能为空；比如：姓名、学号等</p>
<p><strong>2）DEFAULT</strong></p>
<p>默认，用于保证该字段有默认值；比如：性别</p>
<p><strong>3）PRIMARY KEY</strong></p>
<p>主键，用于保证该字段的值具有唯一性，并且非空；比如：学号、员工编号等</p>
<p><strong>4）UNIQUE</strong></p>
<p>唯一，用于保证该字段的值具有唯一性，可以为空；比如：座位号</p>
<p><strong>5）CHECK</strong></p>
<p>检查约束【mysql中不支持】；比如：年龄、性别</p>
<p><strong>6）FOREIGN KEY</strong></p>
<p>外键，用于限制两个表的关系，用于保证该字段的值必须来自于主表的关联列的值；在从表添加外键约束，用于引用主表中某列的值；比如：学生表的专业编号，员工表的部门编号，员工表的工种编号</p>
<h4 id="4-4-3-约束的添加分类"><a href="#4-4-3-约束的添加分类" class="headerlink" title="4.4.3 约束的添加分类"></a>4.4.3 约束的添加分类</h4><p><strong>1）列级约束</strong></p>
<p>六大约束语法上都支持，但外键约束没有效果    </p>
<p><strong>2）表级约束</strong></p>
<p>除了非空、默认，其他的都支持    </p>
<p><strong>添加约束的时机</strong>：① 创建表时；② 修改表时</p>
<p>主键和唯一的大对比：</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">保证唯一性</th>
<th align="center">是否允许为空</th>
<th align="center">一个表中可以有多少个</th>
<th align="center">是否允许组合</th>
</tr>
</thead>
<tbody><tr>
<td align="center">主键</td>
<td align="center">√</td>
<td align="center">×</td>
<td align="center">至多有1个</td>
<td align="center">√，但不推荐</td>
</tr>
<tr>
<td align="center">唯一</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">可以有多个</td>
<td align="center">√，但不推荐</td>
</tr>
</tbody></table>
<p><strong>外键</strong></p>
<p>① 从表设置外键关系</p>
<p>② 外键列的类型和主表的关联列的类型要求一致或兼容，名称无要求</p>
<p>③ 关联列必须是一个key（一般是主键或唯一）</p>
<p>④ 插入数据时，先插入主表，再插入从表；删除数据时，先删除从表，再删除主表</p>
<h4 id="4-4-4-语法"><a href="#4-4-4-语法" class="headerlink" title="4.4.4 语法"></a>4.4.4 语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名(</span><br><span class="line">	字段名 字段类型 列级约束,</span><br><span class="line">	字段名 字段类型,</span><br><span class="line">	表级约束</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>1）创建表时添加约束</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE students ;</span><br><span class="line"></span><br><span class="line"># 一、创建表时添加约束</span><br><span class="line"># 1.添加列级约束</span><br><span class="line">/*</span><br><span class="line">语法：</span><br><span class="line"></span><br><span class="line">直接在字段名和类型后面追加 约束类型 即可。</span><br><span class="line"></span><br><span class="line">只支持：默认、非空、主键、唯一</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">USE students ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE stuinfo (</span><br><span class="line">  id INT PRIMARY KEY,</span><br><span class="line">  # 主键</span><br><span class="line">  stuName VARCHAR (20) NOT NULL,</span><br><span class="line">  # 非空</span><br><span class="line">  gender CHAR(1) CHECK (gender = &#x27;男&#x27; </span><br><span class="line">    OR gender = &#x27;女&#x27;),</span><br><span class="line">  # 检查</span><br><span class="line">  seat INT UNIQUE,</span><br><span class="line">  # 唯一</span><br><span class="line">  age INT DEFAULT 18,</span><br><span class="line">  # 默认约束</span><br><span class="line">  majorId INT REFERENCES major (id) # 外键</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE major (</span><br><span class="line">  id INT PRIMARY KEY,</span><br><span class="line">  majorName VARCHAR (20)</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">DESC stuinfo ;</span><br><span class="line"># 查看stuinfo表中所有的索引，包括主键、外键、唯一</span><br><span class="line">SHOW INDEX FROM stuinfo ;</span><br><span class="line"></span><br><span class="line"># 2.添加表级约束</span><br><span class="line">/*</span><br><span class="line">语法：在各个字段的最下面</span><br><span class="line"> 【constraint 约束名】 约束类型(字段名) </span><br><span class="line"> </span><br><span class="line">*/</span><br><span class="line">DROP TABLE IF EXISTS stuinfo ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE stuinfo (</span><br><span class="line">  id INT,</span><br><span class="line">  stuname VARCHAR (20),</span><br><span class="line">  gender CHAR(1),</span><br><span class="line">  seat INT,</span><br><span class="line">  age INT,</span><br><span class="line">  majorid INT,</span><br><span class="line">  CONSTRAINT pk PRIMARY KEY (id),</span><br><span class="line">  #主键</span><br><span class="line">  CONSTRAINT uq UNIQUE (seat),</span><br><span class="line">  #唯一键</span><br><span class="line">  CONSTRAINT ck CHECK (gender = &#x27;男&#x27; </span><br><span class="line">    OR gender = &#x27;女&#x27;),</span><br><span class="line">  #检查</span><br><span class="line">  CONSTRAINT fk_stuinfo_major FOREIGN KEY (majorid) REFERENCES major (id) #外键</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">SHOW INDEX FROM stuinfo ;</span><br><span class="line"></span><br><span class="line"># 通用的写法：★</span><br><span class="line">CREATE TABLE IF NOT EXISTS stuinfo (</span><br><span class="line">  id INT PRIMARY KEY,</span><br><span class="line">  stuname VARCHAR (20),</span><br><span class="line">  sex CHAR(1),</span><br><span class="line">  age INT DEFAULT 18,</span><br><span class="line">  seat INT UNIQUE,</span><br><span class="line">  majorid INT,</span><br><span class="line">  CONSTRAINT fk_stuinfo_major FOREIGN KEY (majorid) REFERENCES major (id)</span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<p><strong>2）修改表时添加约束</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"># 二、修改表时添加约束</span><br><span class="line">/*</span><br><span class="line">1、添加列级约束</span><br><span class="line">alter table 表名 modify column 字段名 字段类型 新约束;</span><br><span class="line"></span><br><span class="line">2、添加表级约束</span><br><span class="line">alter table 表名 add 【constraint 约束名】 约束类型(字段名) 【外键的引用】;</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">DROP TABLE IF EXISTS stuinfo ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE stuinfo (</span><br><span class="line">  id INT,</span><br><span class="line">  stuname VARCHAR (20),</span><br><span class="line">  gender CHAR(1),</span><br><span class="line">  seat INT,</span><br><span class="line">  age INT,</span><br><span class="line">  majorid INT</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">DESC stuinfo ;</span><br><span class="line"></span><br><span class="line"># 1.添加非空约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  MODIFY COLUMN stuname VARCHAR (20) NOT NULL ;</span><br><span class="line"></span><br><span class="line">#2.添加默认约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  MODIFY COLUMN age INT DEFAULT 18 ;</span><br><span class="line"></span><br><span class="line"># 3.添加主键</span><br><span class="line"># ①列级约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  MODIFY COLUMN id INT PRIMARY KEY ;</span><br><span class="line"></span><br><span class="line"># ②表级约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  ADD PRIMARY KEY (id) ;</span><br><span class="line"></span><br><span class="line"># 4.添加唯一</span><br><span class="line"># ①列级约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  MODIFY COLUMN seat INT UNIQUE ;</span><br><span class="line"></span><br><span class="line"># ②表级约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  ADD UNIQUE (seat) ;</span><br><span class="line"></span><br><span class="line"># 5.添加外键</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  ADD CONSTRAINT fk_stuinfo_major FOREIGN KEY (majorid) REFERENCES major (id) ;</span><br></pre></td></tr></table></figure>

<p><strong>3）修改表时删除约束</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 三、修改表时删除约束</span><br><span class="line"># 1.删除非空约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  MODIFY COLUMN stuname VARCHAR (20) NULL ;</span><br><span class="line"></span><br><span class="line"># 2.删除默认约束</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  MODIFY COLUMN age INT ;</span><br><span class="line"></span><br><span class="line"># 3.删除主键</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  DROP PRIMARY KEY ;</span><br><span class="line"></span><br><span class="line"># 4.删除唯一</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  DROP INDEX seat ;</span><br><span class="line"></span><br><span class="line"># 5.删除外键</span><br><span class="line">ALTER TABLE stuinfo </span><br><span class="line">  DROP FOREIGN KEY fk_stuinfo_major ;</span><br><span class="line"></span><br><span class="line">SHOW INDEX FROM stuinfo ;</span><br></pre></td></tr></table></figure>

<h3 id="4-5-标识列"><a href="#4-5-标识列" class="headerlink" title="4.5 标识列"></a>4.5 标识列</h3><h4 id="4-5-1-含义"><a href="#4-5-1-含义" class="headerlink" title="4.5.1 含义"></a>4.5.1 含义</h4><p>又称为自增长列，可以不用手动的插入值，系统提供默认的序列值</p>
<p>含义：可以不用手动的插入值，系统提供默认的序列值</p>
<h4 id="4-5-2-特点"><a href="#4-5-2-特点" class="headerlink" title="4.5.2 特点"></a>4.5.2 特点</h4><p>1）标识列必须和主键搭配吗？不一定，但要求是一个key</p>
<p>2）一个表可以有几个标识列？至多一个！</p>
<p>3）标识列的类型只能是数值型</p>
<p>4）标识列可以通过 <code>SET auto_increment_increment=3;设置步长</code>;可以通过手动插入值，设置起始值</p>
<h4 id="4-5-3-创建表时设置标识列"><a href="#4-5-3-创建表时设置标识列" class="headerlink" title="4.5.3 创建表时设置标识列"></a>4.5.3 创建表时设置标识列</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 一、创建表时设置标识列</span><br><span class="line">DROP TABLE IF EXISTS tab_identity ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_identity (</span><br><span class="line">  id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">  NAME VARCHAR(20) </span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">TRUNCATE TABLE tab_identity ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_identity(id,NAME) VALUES(NULL,&#x27;john&#x27;);</span><br><span class="line">INSERT INTO tab_identity(NAME) VALUES(&#x27;lucy&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_identity;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;%auto_increment%&#x27; ;</span><br><span class="line"></span><br><span class="line">SET auto_increment_increment = 3 ;</span><br></pre></td></tr></table></figure>

<h4 id="4-5-4-修改表时设置标识列"><a href="#4-5-4-修改表时设置标识列" class="headerlink" title="4.5.4 修改表时设置标识列"></a>4.5.4 修改表时设置标识列</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 二、修改表时设置标识列</span><br><span class="line">ALTER TABLE tab_identity </span><br><span class="line">  MODIFY COLUMN id INT PRIMARY KEY AUTO_INCREMENT ;</span><br></pre></td></tr></table></figure>

<h4 id="4-5-5-修改表时删除标识列"><a href="#4-5-5-修改表时删除标识列" class="headerlink" title="4.5.5 修改表时删除标识列"></a>4.5.5 修改表时删除标识列</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 三、修改表时删除标识列</span><br><span class="line">ALTER TABLE tab_identity </span><br><span class="line">  MODIFY COLUMN id INT ;</span><br></pre></td></tr></table></figure>


<hr>
<h2 id="第五章-TCL语言"><a href="#第五章-TCL语言" class="headerlink" title="第五章 TCL语言"></a>第五章 TCL语言</h2><p>TCL（Transmission Control Language）：事务控制语言</p>
<h3 id="5-1-事务"><a href="#5-1-事务" class="headerlink" title="5.1 事务"></a>5.1 事务</h3><h4 id="5-1-1-概念"><a href="#5-1-1-概念" class="headerlink" title="5.1.1 概念"></a>5.1.1 概念</h4><p>一个或一组sql语句组成一个执行单元，这个执行单元要么全部执行，要么全部不执行。</p>
<h4 id="5-1-2特性"><a href="#5-1-2特性" class="headerlink" title="5.1.2特性"></a>5.1.2特性</h4><p><code>ACID</code><br>原子性（Atomicity）：一个事务不可再分割，要么都执行要么都不执行<br>一致性（Consistency）：一个事务执行会使数据从一个一致状态切换到另外一个一致状态<br>隔离性（Isolation）：一个事务的执行不受其他事务的干扰<br>持久性（Durability）：一个事务一旦提交，则会永久的改变数据库的数据.</p>
<h4 id="5-1-3-分类"><a href="#5-1-3-分类" class="headerlink" title="5.1.3 分类"></a>5.1.3 分类</h4><p><strong>隐式事务</strong>：事务没有明显的开启和结束的标记<br>比如：insert、update、delete语句</p>
<p><strong>显式事务</strong>：事务具有明显的开启和结束的标记<br>前提：必须先设置自动提交功能为禁用</p>
<h3 id="5-2-事务的创建"><a href="#5-2-事务的创建" class="headerlink" title="5.2 事务的创建"></a>5.2 事务的创建</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 步骤1：开启事务</span><br><span class="line">SET autocommit = 0;</span><br><span class="line">START TRANSACTION; # 可选的</span><br><span class="line"># 步骤2：编写事务中的sql语句（select insert update delete）</span><br><span class="line">语句1;</span><br><span class="line">语句2;</span><br><span class="line">...</span><br><span class="line"># 步骤3：结束事务</span><br><span class="line">COMMIT; # 提交事务</span><br><span class="line">ROLLBACK; # 回滚事务</span><br><span class="line">SAVEPOINT 节点名; # 设置保存点</span><br></pre></td></tr></table></figure>

<h3 id="5-3-并发事务"><a href="#5-3-并发事务" class="headerlink" title="5.3 并发事务"></a>5.3 并发事务</h3><p>1 事务的并发问题是如何发生的？</p>
<p>多个事务<strong>同时</strong>操作<strong>同一个</strong>数据库的相同数据时</p>
<p>2 并发问题都有哪些？</p>
<p><strong>脏读</strong>：一个事务读取了其他事务还没有提交的数据，读到的是其他事务“更新”的数据</p>
<p><strong>不可重复读</strong>：一个事务多次读取，结果不一样</p>
<p><strong>幻读</strong>：一个事务读取了其他事务还没有提交的数据，只是读到的是 其他事务“插入”的数据</p>
<p>3 如何解决并发问题？</p>
<p>通过设置<strong>隔离级别</strong>来解决</p>
<table>
<thead>
<tr>
<th align="center">事务的隔离级别</th>
<th align="center">脏读</th>
<th align="center">不可重复读</th>
<th align="center">幻读</th>
</tr>
</thead>
<tbody><tr>
<td align="center">read uncommitted</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">read committed</td>
<td align="center">×</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">repeatable read</td>
<td align="center">×</td>
<td align="center">×</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">serializable</td>
<td align="center">×</td>
<td align="center">×</td>
<td align="center">×</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>mysql</strong>中默认第三个隔离级别 repeatable read<br><strong>oracle</strong>中默认第二个隔离级别 read committed</p>
</blockquote>
<p><strong>查看隔离级别</strong>：<code>select @@tx_isolation;</code></p>
<p><strong>设置隔离级别</strong>：<code>set session|global transaction isolation level 隔离级别;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SHOW ENGINES ; # 查看数据库引擎</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;autocommit&#x27; ;</span><br><span class="line"></span><br><span class="line">USE test;</span><br><span class="line">CREATE TABLE account (</span><br><span class="line">  id INT PRIMARY KEY,</span><br><span class="line">  username VARCHAR (20),</span><br><span class="line">  balance DOUBLE</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO account VALUE (1, &#x27;张无忌&#x27;, 1000),</span><br><span class="line">(2, &#x27;赵敏&#x27;, 1000) ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 演示事务的使用步骤</span><br><span class="line"># 1 开启事务</span><br><span class="line">SET autocommit=0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line"></span><br><span class="line"># 2 编写一组事务的语句</span><br><span class="line">UPDATE account SET balance = 1000 WHERE username=&#x27;张无忌&#x27;;</span><br><span class="line">UPDATE account SET balance = 1000 WHERE username=&#x27;赵敏&#x27;;</span><br><span class="line"></span><br><span class="line"># 3 结束事务</span><br><span class="line">ROLLBACK;</span><br><span class="line"># commit;</span><br><span class="line"></span><br><span class="line">SELECT * FROM account;</span><br></pre></td></tr></table></figure>

<p><strong>演示事务对于<code>delete</code>和<code>truncate</code>的处理的区别</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 演示delete--还原，和原来一样</span><br><span class="line">SET autocommit=0;</span><br><span class="line">START TRANSACTION ;</span><br><span class="line">DELETE FROM account;</span><br><span class="line">ROLLBACK;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 演示truncate--数据删除，只剩表格</span><br><span class="line">SET autocommit=0;</span><br><span class="line">START TRANSACTION ;</span><br><span class="line">TRUNCATE TABLE account;</span><br><span class="line">ROLLBACK;</span><br></pre></td></tr></table></figure>

<p><strong>演示<code>savepoint</code>的使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 演示savepoint 的使用</span><br><span class="line">SET autocommit=0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM account WHERE id=25;</span><br><span class="line">SAVEPOINT a;# 设置保存点</span><br><span class="line">DELETE FROM account WHERE id=28;</span><br><span class="line">ROLLBACK TO a;# 回滚到保存点</span><br><span class="line"></span><br><span class="line">SELECT * FROM account</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="第六章-其他"><a href="#第六章-其他" class="headerlink" title="第六章 其他"></a>第六章 其他</h2><p>视图、变量、存储过程、函数、流程控制过程</p>
<h3 id="6-1-视图"><a href="#6-1-视图" class="headerlink" title="6.1 视图"></a>6.1 视图</h3><p><strong>含义</strong>：虚拟表，和普通表一样使用</p>
<blockquote>
<p>mysql5.1版本出现的新特性，是通过表动态生成的数据</p>
</blockquote>
<table>
<thead>
<tr>
<th></th>
<th>创建语法的关键字</th>
<th>是否实际占用物理空间</th>
<th>使用</th>
</tr>
</thead>
<tbody><tr>
<td>视图</td>
<td>create view</td>
<td>只是保存了sql逻辑</td>
<td>增删改查，只是一般不能增删改</td>
</tr>
<tr>
<td>表</td>
<td>create table</td>
<td>保存了数据</td>
<td>增删改查</td>
</tr>
</tbody></table>
<h4 id="6-1-1-创建视图"><a href="#6-1-1-创建视图" class="headerlink" title="6.1.1 创建视图"></a>6.1.1 创建视图</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW 视图名 AS</span><br><span class="line">查询语句;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line"># 1.查询姓名中包含a字符的员工名、部门名和工种信息</span><br><span class="line"># ① 创建</span><br><span class="line">CREATE VIEW myv1 AS </span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  department_name,</span><br><span class="line">  job_title </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  JOIN departments d </span><br><span class="line">    ON e.department_id = d.department_id </span><br><span class="line">  JOIN jobs j </span><br><span class="line">    ON j.job_id = e.job_id ;</span><br><span class="line"></span><br><span class="line"># ② 使用</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  myv1 </span><br><span class="line">WHERE last_name LIKE &#x27;%a%&#x27; ;</span><br><span class="line"></span><br><span class="line"># 2.查询各部门的平均工资级别</span><br><span class="line"># ① 创建视图查看每个部门的平均工资</span><br><span class="line">CREATE VIEW myv2 AS </span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary) ag,</span><br><span class="line">  department_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY department_id ;</span><br><span class="line"></span><br><span class="line"># ② 使用</span><br><span class="line">SELECT </span><br><span class="line">  myv2.`ag`,</span><br><span class="line">  g.grade_level </span><br><span class="line">FROM</span><br><span class="line">  myv2 </span><br><span class="line">  JOIN job_grades g </span><br><span class="line">    ON myv2.`ag` BETWEEN g.`lowest_sal` </span><br><span class="line">    AND g.`highest_sal` ;</span><br><span class="line"></span><br><span class="line"># 3.查询平均工资最低的部门信息</span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  myv2 </span><br><span class="line">ORDER BY ag </span><br><span class="line">LIMIT 1 ;</span><br><span class="line"></span><br><span class="line">#4.查询平均工资最低的部门名和工资</span><br><span class="line">CREATE VIEW myv3 AS </span><br><span class="line">SELECT </span><br><span class="line">  * </span><br><span class="line">FROM</span><br><span class="line">  myv2 </span><br><span class="line">ORDER BY ag </span><br><span class="line">LIMIT 1 ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  d.*,</span><br><span class="line">  m.ag </span><br><span class="line">FROM</span><br><span class="line">  myv3 m </span><br><span class="line">  JOIN departments d </span><br><span class="line">    ON m.`department_id` = d.`department_id` ;				</span><br></pre></td></tr></table></figure>

<h4 id="6-1-2-视图的修改"><a href="#6-1-2-视图的修改" class="headerlink" title="6.1.2 视图的修改"></a>6.1.2 视图的修改</h4><p><strong>1）方式一</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW  视图名 AS</span><br><span class="line">查询语句;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW myv3 AS </span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary),</span><br><span class="line">  job_id </span><br><span class="line">FROM</span><br><span class="line">  employees </span><br><span class="line">GROUP BY job_id ;</span><br></pre></td></tr></table></figure>

<p><strong>2）方式二</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER VIEW 视图名 AS </span><br><span class="line">查询语句;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ALTER VIEW myv3 </span><br><span class="line">  AS </span><br><span class="line">  SELECT </span><br><span class="line">    * </span><br><span class="line">  FROM</span><br><span class="line">    employees ;</span><br></pre></td></tr></table></figure>

<h4 id="6-1-3-删除视图"><a href="#6-1-3-删除视图" class="headerlink" title="6.1.3 删除视图"></a>6.1.3 删除视图</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP VIEW 视图名,视图名,...;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DROP VIEW emp_v1,</span><br><span class="line">emp_v2,</span><br><span class="line">myv3 ;</span><br></pre></td></tr></table></figure>

<h4 id="6-1-4-查看视图"><a href="#6-1-4-查看视图" class="headerlink" title="6.1.4 查看视图"></a>6.1.4 查看视图</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DESC 视图名 ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE VIEW myv3 ;</span><br></pre></td></tr></table></figure>

<h4 id="6-1-5-视图的更新"><a href="#6-1-5-视图的更新" class="headerlink" title="6.1.5 视图的更新"></a>6.1.5 视图的更新</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW myv1 AS </span><br><span class="line">SELECT </span><br><span class="line">  last_name,</span><br><span class="line">  email </span><br><span class="line">FROM</span><br><span class="line">  employees ;</span><br><span class="line"></span><br><span class="line"># 1.插入</span><br><span class="line">INSERT INTO myv1 </span><br><span class="line">VALUES</span><br><span class="line">  (&#x27;张飞&#x27;, &#x27;zf@qq.com&#x27;) ;</span><br><span class="line"></span><br><span class="line"># 2.修改</span><br><span class="line">UPDATE </span><br><span class="line">  myv1 </span><br><span class="line">SET</span><br><span class="line">  last_name = &#x27;张无忌&#x27; </span><br><span class="line">WHERE last_name = &#x27;张飞&#x27; ;</span><br><span class="line"></span><br><span class="line"># 3.删除</span><br><span class="line">DELETE </span><br><span class="line">FROM</span><br><span class="line">  myv1 </span><br><span class="line">WHERE last_name = &#x27;张无忌&#x27; ;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>具备以下特点的视图不允许更新</p>
<p>① 包含以下关键字的sql语句：分组函数、distinct、group  by、having、union或者union all</p>
<p>② 常量视图</p>
<p>③ select中包含子查询</p>
<p>④ join（不能插入）</p>
<p>⑤ from一个不能更新的视图</p>
<p>⑥ where子句的子查询引用了from子句中的表</p>
</blockquote>
<h3 id="6-2-变量"><a href="#6-2-变量" class="headerlink" title="6.2 变量"></a>6.2 变量</h3><h4 id="6-2-1-分类"><a href="#6-2-1-分类" class="headerlink" title="6.2.1 分类"></a>6.2.1 分类</h4><table>
<thead>
<tr>
<th align="center">系统变量</th>
<th align="center">自定义变量</th>
</tr>
</thead>
<tbody><tr>
<td align="center">全局变量</td>
<td align="center">用户变量</td>
</tr>
<tr>
<td align="center">会话变量</td>
<td align="center">局部变量</td>
</tr>
</tbody></table>
<h4 id="6-2-2-系统变量"><a href="#6-2-2-系统变量" class="headerlink" title="6.2.2 系统变量"></a>6.2.2 系统变量</h4><p><strong>说明</strong></p>
<p>变量有系统提供，不是用户定义，属于服务器层面</p>
<p><strong>语法</strong></p>
<p><strong>1）查看所有的系统变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global|【session】 variables;</span><br></pre></td></tr></table></figure>

<p><strong>2）查看满足条件的部分系统变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global|【session】 variables like &#x27;%char%&#x27;;</span><br></pre></td></tr></table></figure>

<p><strong>3）查看指定的系统变量的值</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@global|【session】.系统变量名;</span><br></pre></td></tr></table></figure>

<p><strong>4）为某个系统变量赋值</strong><br><strong>方式一</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set global|【session】系统变量名 = 值;</span><br></pre></td></tr></table></figure>

<p><strong>方式二</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @@global|【session】系统变量名 = 值;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意</strong></p>
<p>如果是全局级别，则需要加global，如果是会话级别，则需要加session，如果不写，则默认session</p>
</blockquote>
<p><strong>1）全局变量</strong></p>
<p><strong>作用域</strong>：服务器每次启动将为所有的全局变量赋初始值，针对于所有会话（连接）有效，但不能跨重启</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># ① 查看所有全局变量</span><br><span class="line">SHOW GLOBAL VARIABLES ;</span><br><span class="line"></span><br><span class="line"># ② 查看满足条件的部分系统变量</span><br><span class="line">SHOW GLOBAL VARIABLES LIKE &#x27;%char%&#x27; ;</span><br><span class="line"></span><br><span class="line"># ③ 查看指定的系统变量的值</span><br><span class="line">SELECT </span><br><span class="line">  @@global.autocommit ;</span><br><span class="line"></span><br><span class="line"># ④ 为某个系统变量赋值</span><br><span class="line">SET @@global.autocommit = 0 ;</span><br><span class="line"></span><br><span class="line">SET GLOBAL autocommit = 0 ;</span><br></pre></td></tr></table></figure>

<p><strong>2）会话变量</strong></p>
<p><strong>作用域</strong>：针对于当前会话（连接）有效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># ① 查看所有会话变量</span><br><span class="line">SHOW SESSION VARIABLES ;</span><br><span class="line"></span><br><span class="line"># ② 查看满足条件的部分会话变量</span><br><span class="line">SHOW SESSION VARIABLES LIKE &#x27;%char%&#x27; ;</span><br><span class="line"></span><br><span class="line"># ③ 查看指定的会话变量的值</span><br><span class="line">SELECT </span><br><span class="line">  @@autocommit ;</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">  @@session.tx_isolation ;</span><br><span class="line"></span><br><span class="line"># ④ 为某个会话变量赋值</span><br><span class="line"># 方式一：</span><br><span class="line">SET @@session.tx_isolation = &#x27;read-uncommitted&#x27; ;</span><br><span class="line"></span><br><span class="line"># 方式二：</span><br><span class="line">SET SESSION tx_isolation = &#x27;read-committed&#x27; ;</span><br></pre></td></tr></table></figure>

<h4 id="6-2-3-自定义变量"><a href="#6-2-3-自定义变量" class="headerlink" title="6.2.3 自定义变量"></a>6.2.3 自定义变量</h4><p><strong>说明</strong></p>
<p>变量由用户自定义，而不是系统提供的</p>
<p><strong>使用步骤</strong></p>
<p>声明 → 赋值 → 使用（查看、比较、运算等）</p>
<p><strong>1）用户变量</strong></p>
<p><strong>作用域</strong>：针对于当前会话（连接）有效，作用域同于<strong>会话变量</strong>，应用在任何地方，begin end中 或 begin end的外面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 赋值操作符：=或:=</span><br><span class="line"># ① 声明并初始化</span><br><span class="line">SET @用户变量名 = 值;</span><br><span class="line">SET @用户变量名 := 值;</span><br><span class="line">SELECT @用户变量名 := 值;</span><br><span class="line"></span><br><span class="line"># ② 赋值（更新变量的值）</span><br><span class="line"># 方式一：</span><br><span class="line">	SET @用户变量名 = 值;</span><br><span class="line">	SET @用户变量名 := 值;</span><br><span class="line">	SELECT @用户变量名 := 值;</span><br><span class="line"># 方式二：</span><br><span class="line">	SELECT 字段 INTO @变量名</span><br><span class="line">	FROM 表;</span><br><span class="line"># ③ 使用（查看变量的值）</span><br><span class="line">SELECT @变量名;</span><br><span class="line"></span><br><span class="line"># 案例</span><br><span class="line"># 1、声明并初始化</span><br><span class="line">SET @name = &#x27;john&#x27;;</span><br><span class="line">SET @name = 100;</span><br><span class="line">SET @account = 1;</span><br><span class="line"></span><br><span class="line"># 2、赋值</span><br><span class="line">SELECT COUNT(*) INTO @count</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line"># 3、查看</span><br><span class="line">SELECT @count;</span><br></pre></td></tr></table></figure>

<p><strong>2）局部变量</strong></p>
<p><strong>作用域</strong>：仅仅在定义它的begin end块中有效，应用在 begin end中的第一句话</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># ① 声明</span><br><span class="line">DECLARE 变量名 类型;</span><br><span class="line">DECLARE 变量名 类型 DEFAULT 值 ;</span><br><span class="line"></span><br><span class="line"># ② 赋值（更新变量的值）</span><br><span class="line"># 方式一：通过set或select</span><br><span class="line">	SET 局部变量名=值;</span><br><span class="line">	SET 局部变量名:=值;</span><br><span class="line">	SELECT @局部变量名:=值;</span><br><span class="line"># 方式二：通过select into</span><br><span class="line">	SELECT 字段 INTO 具备变量名</span><br><span class="line">	FROM 表;</span><br><span class="line"># ③ 使用（查看变量的值）</span><br><span class="line">SELECT 局部变量名;</span><br></pre></td></tr></table></figure>

<p><strong>3）用户变量和局部变量的对比</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">作用域</th>
<th align="center">定义位置</th>
<th align="center">语法</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>用户变量</strong></td>
<td align="center">当前会话</td>
<td align="center">会话的任何地方</td>
<td align="center">加@符号，不用限定类型</td>
</tr>
<tr>
<td align="center"><strong>局部变量</strong></td>
<td align="center">BEGIN END中</td>
<td align="center">BEGIN END的第一句话</td>
<td align="center">一般不用加@,需要限定类型</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 案例：声明两个变量，求和并打印</span><br><span class="line"></span><br><span class="line"># 用户变量</span><br><span class="line">SET @m = 1;</span><br><span class="line">SET @n = 2;</span><br><span class="line">SET @sum = @m + @n;</span><br><span class="line">SELECT @sum;</span><br><span class="line"></span><br><span class="line"># 局部变量</span><br><span class="line">DECLARE m INT DEFAULT 1;</span><br><span class="line">DECLARE n INT DEFAULT 2;</span><br><span class="line">DECLARE SUM INT;</span><br><span class="line">SET SUM = m + n;</span><br><span class="line">SELECT SUM;		</span><br></pre></td></tr></table></figure>

<h3 id="6-3-存储过程"><a href="#6-3-存储过程" class="headerlink" title="6.3 存储过程"></a>6.3 存储过程</h3><p><strong>含义</strong></p>
<p>一组预先编译好的SQL语句的集合，理解成批处理语句</p>
<p><strong>优点</strong></p>
<p>1）提高代码的重用性</p>
<p>2）简化操作</p>
<p>3）减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</p>
<h4 id="6-3-1-创建语法"><a href="#6-3-1-创建语法" class="headerlink" title="6.3.1 创建语法"></a>6.3.1 创建语法</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE 存储过程名(参数列表)</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">	存储过程体（一组合法的SQL语句）</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<p>1）参数列表包含三部分</p>
<p><code>参数模式  参数名  参数类型</code></p>
<p>举例：<code>in stuname varchar(20)</code></p>
<p><strong>参数模式</strong></p>
<p><code>in</code>：该参数可以作为输入，也就是该参数需要调用方传入值</p>
<p><code>out</code>：该参数可以作为输出，也就是该参数可以作为返回值</p>
<p><code>inout</code>：该参数既可以作为输入又可以作为输出，也就是该参数既需要传入值，又可以返回值</p>
<p>2）如果存储过程体仅仅只有一句话，begin end可以省略</p>
<p>存储过程体中的每条sql语句的结尾要求必须加分号</p>
<p>存储过程的结尾可以使用 <code>delimiter</code> 重新设置</p>
<p>语法：<code>delimiter 结束标记</code></p>
<p>举例：<code>delimiter $</code></p>
<h4 id="6-3-2-调用语法"><a href="#6-3-2-调用语法" class="headerlink" title="6.3.2 调用语法"></a>6.3.2 调用语法</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CALL 存储过程名(实参列表);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"># 1.空参列表</span><br><span class="line"># 案例：插入到admin表中五条记录</span><br><span class="line">SELECT * FROM admin;</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line">CREATE PROCEDURE myp1 () </span><br><span class="line">BEGIN</span><br><span class="line">  INSERT INTO admin (username, `password`) </span><br><span class="line">  VALUES</span><br><span class="line">    (&#x27;john1&#x27;, &#x27;0000&#x27;),</span><br><span class="line">    (&#x27;lily&#x27;, &#x27;0000&#x27;),</span><br><span class="line">    (&#x27;rose&#x27;, &#x27;0000&#x27;),</span><br><span class="line">    (&#x27;jack&#x27;, &#x27;0000&#x27;),</span><br><span class="line">    (&#x27;tom&#x27;, &#x27;0000&#x27;) ;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"># 调用</span><br><span class="line">CALL myp1()$</span><br><span class="line"></span><br><span class="line"># 2.创建带in模式参数的存储过程</span><br><span class="line"># 案例1：创建存储过程实现 根据女神名，查询对应的男神信息</span><br><span class="line">CREATE PROCEDURE myp2 (IN beautyName VARCHAR (20)) </span><br><span class="line">BEGIN</span><br><span class="line">  SELECT </span><br><span class="line">    bo.* </span><br><span class="line">  FROM</span><br><span class="line">    boys bo </span><br><span class="line">    RIGHT JOIN beauty b </span><br><span class="line">      ON bo.id = b.boyfriend_id </span><br><span class="line">  WHERE b.name = beautyName ;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"># 调用</span><br><span class="line">CALL myp2(&#x27;王语嫣&#x27;)$</span><br><span class="line">  </span><br><span class="line"># 案例2 ：创建存储过程实现，用户是否登录成功</span><br><span class="line">CREATE PROCEDURE myp3 (</span><br><span class="line">  IN username VARCHAR (20),</span><br><span class="line">  IN PASSWORD VARCHAR (20)</span><br><span class="line">) </span><br><span class="line">BEGIN</span><br><span class="line">  DECLARE result INT DEFAULT 0 ;#声明并初始化</span><br><span class="line">  SELECT </span><br><span class="line">    COUNT(*) INTO result #赋值</span><br><span class="line">  FROM</span><br><span class="line">    admin </span><br><span class="line">  WHERE admin.username = username </span><br><span class="line">    AND admin.password = PASSWORD ;</span><br><span class="line">  SELECT </span><br><span class="line">    IF(result &gt; 0, &#x27;成功&#x27;, &#x27;失败&#x27;) ;#使用</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"># 调用</span><br><span class="line">CALL myp3(&#x27;张飞&#x27;,&#x27;8888&#x27;)$</span><br><span class="line"></span><br><span class="line"># 3.创建out 模式参数的存储过程</span><br><span class="line"># 案例1：根据输入的女神名，返回对应的男神名</span><br><span class="line">CREATE PROCEDURE myp4 (</span><br><span class="line">  IN beautyName VARCHAR (20),</span><br><span class="line">  OUT boyName VARCHAR (20)</span><br><span class="line">) </span><br><span class="line">BEGIN</span><br><span class="line">  SELECT </span><br><span class="line">    bo.boyname INTO boyname </span><br><span class="line">  FROM</span><br><span class="line">    boys bo </span><br><span class="line">    RIGHT JOIN beauty b </span><br><span class="line">      ON b.boyfriend_id = bo.id </span><br><span class="line">  WHERE b.name = beautyName ;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"># 调用</span><br><span class="line">CALL myp4(&#x27;小昭&#x27;,@name)$</span><br><span class="line">SELECT @name$    </span><br><span class="line">    </span><br><span class="line"># 案例2：根据输入的女神名，返回对应的男神名和魅力值</span><br><span class="line">CREATE PROCEDURE myp5 (</span><br><span class="line">  IN beautyName VARCHAR (20),</span><br><span class="line">  OUT boyName VARCHAR (20),</span><br><span class="line">  OUT usercp INT</span><br><span class="line">) </span><br><span class="line">BEGIN</span><br><span class="line">  SELECT </span><br><span class="line">    boys.boyname,</span><br><span class="line">    boys.usercp INTO boyname,</span><br><span class="line">    usercp </span><br><span class="line">  FROM</span><br><span class="line">    boys </span><br><span class="line">    RIGHT JOIN beauty b </span><br><span class="line">      ON b.boyfriend_id = boys.id </span><br><span class="line">  WHERE b.name = beautyName ;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"># 调用</span><br><span class="line">CALL myp5(&#x27;小昭&#x27;,@name,@cp)$</span><br><span class="line">SELECT @name,@cp$    </span><br><span class="line"></span><br><span class="line"># 4.创建带inout模式参数的存储过程</span><br><span class="line"># 案例1：传入a和b两个值，最终a和b都翻倍并返回</span><br><span class="line">CREATE PROCEDURE myp6 (INOUT a INT, INOUT b INT) </span><br><span class="line">BEGIN</span><br><span class="line">  SET a = a * 2 ;</span><br><span class="line">  SET b = b * 2 ;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"># 调用</span><br><span class="line">SET @m=10$</span><br><span class="line">SET @n=20$</span><br><span class="line">CALL myp6(@m,@n)$</span><br><span class="line">SELECT @m,@n$</span><br></pre></td></tr></table></figure>

<h4 id="6-3-3-删除语法"><a href="#6-3-3-删除语法" class="headerlink" title="6.3.3 删除语法"></a>6.3.3 删除语法</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop procedure 存储过程名</span><br></pre></td></tr></table></figure>

<blockquote>
<p>一次只能删除一个</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE p1 ;</span><br><span class="line">DROP PROCEDURE p2,p3 ; # 错误</span><br></pre></td></tr></table></figure>

<h4 id="6-3-4-查看存储过程的信息"><a href="#6-3-4-查看存储过程的信息" class="headerlink" title="6.3.4 查看存储过程的信息"></a>6.3.4 查看存储过程的信息</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE 存储过程名 ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE myp2 ;</span><br><span class="line">DESC myp2 ; # 错误</span><br></pre></td></tr></table></figure>

<h3 id="6-4-函数"><a href="#6-4-函数" class="headerlink" title="6.4 函数"></a>6.4 函数</h3><p><strong>含义</strong></p>
<p>一组预先编译好的SQL语句的集合，理解成批处理语句</p>
<p><strong>优点</strong></p>
<p>1）提高代码的重用性</p>
<p>2）简化操作</p>
<p>3）减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</p>
<h4 id="6-4-1-创建语法"><a href="#6-4-1-创建语法" class="headerlink" title="6.4.1 创建语法"></a>6.4.1 创建语法</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION 函数名 (参数列表) RETURNS 返回类型 </span><br><span class="line">BEGIN</span><br><span class="line">  函数体 </span><br><span class="line">END </span><br></pre></td></tr></table></figure>

<p>注意：<br>1）参数列表包含两部分：<code>参数名 参数类型</code></p>
<p>2）函数体：肯定会有return语句，如果没有会报错<br>如果return语句没有放在函数体的最后也不报错，但不建议</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return 值;</span><br></pre></td></tr></table></figure>

<p>3）函数体中仅有一句话，则可以省略begin end</p>
<p>4）使用 <code>delimiter</code> 语句设置结束标记</p>
<h4 id="6-4-2-调用语法"><a href="#6-4-2-调用语法" class="headerlink" title="6.4.2 调用语法"></a>6.4.2 调用语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">  函数名 (参数列表) 结束标记`</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"># 1.无参有返回</span><br><span class="line"># 案例：返回公司的员工个数</span><br><span class="line">  CREATE FUNCTION myf1 () RETURNS INT </span><br><span class="line">  BEGIN</span><br><span class="line">    DECLARE c INT DEFAULT 0 ;</span><br><span class="line"></span><br><span class="line"> # 定义局部变量</span><br><span class="line">	SELECT COUNT(*) INTO c # 赋值</span><br><span class="line">	FROM employees;</span><br><span class="line">	RETURN c;	</span><br><span class="line"></span><br><span class="line">END $ </span><br><span class="line">SELECT </span><br><span class="line">myf1 () $ </span><br><span class="line"></span><br><span class="line"># 2.有参有返回</span><br><span class="line"># 案例1：根据员工名，返回它的工资</span><br><span class="line"> CREATE FUNCTION myf2 (empName VARCHAR (20)) RETURNS DOUBLE </span><br><span class="line">BEGIN</span><br><span class="line">  SET @sal = 0 ;</span><br><span class="line">  </span><br><span class="line">  #定义用户变量 </span><br><span class="line">	SELECT salary INTO @sal   #赋值</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE last_name = empName;</span><br><span class="line">	</span><br><span class="line">	RETURN @sal;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT myf2(&#x27;k_ing&#x27;) $</span><br><span class="line"></span><br><span class="line"># 案例2：根据部门名，返回该部门的平均工资</span><br><span class="line"></span><br><span class="line">CREATE FUNCTION myf3(deptName VARCHAR(20)) RETURNS DOUBLE</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE sal DOUBLE ;</span><br><span class="line">SELECT </span><br><span class="line">  AVG(salary) INTO sal </span><br><span class="line">FROM</span><br><span class="line">  employees e </span><br><span class="line">  JOIN departments d </span><br><span class="line">    ON e.department_id = d.department_id </span><br><span class="line">WHERE d.department_name = deptName ;</span><br><span class="line"></span><br><span class="line">	RETURN sal;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT myf3(&#x27;IT&#x27;)$</span><br></pre></td></tr></table></figure>

<h4 id="6-4-3-查看函数"><a href="#6-4-3-查看函数" class="headerlink" title="6.4.3 查看函数"></a>6.4.3 查看函数</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE FUNCTION 函数名</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE FUNCTION myf3;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-4-删除函数"><a href="#6-4-4-删除函数" class="headerlink" title="6.4.4 删除函数"></a>6.4.4 删除函数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP FUNCTION 函数名;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP FUNCTION myf3;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-5-存储过程和函数的区别"><a href="#6-4-5-存储过程和函数的区别" class="headerlink" title="6.4.5 存储过程和函数的区别"></a>6.4.5 存储过程和函数的区别</h4><p><strong>存储过程</strong>：可以有0个返回，也可以有多个返回，适合做<strong>批量插入</strong>、<strong>批量更新</strong><br><strong>函数</strong>：有且仅有1个返回，适合做<strong>处理数据后返回一个结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 案例</span><br><span class="line"># 一、创建函数，实现传入两个float，返回二者之和</span><br><span class="line">CREATE FUNCTION test_fun1 (num1 FLOAT, num2 FLOAT) RETURNS FLOAT </span><br><span class="line">BEGIN</span><br><span class="line">  DECLARE SUMFLOAT DEFAULT 0 ;  </span><br><span class="line">  	SET SUM = num1 + num2;</span><br><span class="line">	RETURN SUM;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT test_fun1(1,2)$</span><br></pre></td></tr></table></figure>

<h3 id="6-5-流程控制过程"><a href="#6-5-流程控制过程" class="headerlink" title="6.5 流程控制过程"></a>6.5 流程控制过程</h3><p><strong>分类</strong></p>
<p><strong>顺序结构</strong>：程序从上往下依次执行</p>
<p><strong>分支结构</strong>：程序从两条或多条路径中选择一条去执行</p>
<p><strong>循环结构</strong>：程序在满足一定条件的基础上，重复执行一段代码</p>
<h4 id="6-5-1-分支结构"><a href="#6-5-1-分支结构" class="headerlink" title="6.5.1 分支结构"></a>6.5.1 分支结构</h4><p><strong>1）if函数</strong></p>
<p><strong>功能</strong>：实现简单的双分支</p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(表达式1,表达式2,表达式3)</span><br></pre></td></tr></table></figure>

<p><strong>执行顺序</strong>：如果表达式1成立，则if函数返回表达式2的值，否则返回表达式3的值</p>
<p><strong>应用</strong>：任何地方</p>
<p><strong>2）if结构</strong></p>
<p><strong>功能</strong>：实现多重分支</p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if 条件1 then 语句1;</span><br><span class="line">ifelse 条件2 then 语句2;</span><br><span class="line">...</span><br><span class="line">【else 语句n;】</span><br></pre></td></tr></table></figure>

<p><strong>应用</strong>：在begin end中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 案例1：创建函数，实现传入成绩，如果成绩&gt;90,返回A，如果成绩&gt;80,返回B，如果成绩&gt;60,返回C，否则返回D</span><br><span class="line">CREATE FUNCTION test_if (score INT) RETURNS CHAR </span><br><span class="line">BEGIN</span><br><span class="line">DECLARE ch CHAR DEFAULT &#x27;A&#x27; ;</span><br><span class="line"></span><br><span class="line">	IF score&gt;90 THEN SET ch=&#x27;A&#x27;;</span><br><span class="line">	ELSEIF score&gt;80 THEN SET ch=&#x27;B&#x27;;</span><br><span class="line">	ELSEIF score &gt; 60 </span><br><span class="line">	THEN SET ch = &#x27;C&#x27; ;</span><br><span class="line">	ELSE SET ch=&#x27;D&#x27;;</span><br><span class="line">	END IF;</span><br><span class="line">	RETURN ch;	</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT test_if(87)$</span><br></pre></td></tr></table></figure>

<p><strong>3）case结构</strong></p>
<p><strong>情况1</strong>：类似于java中的switch语句，一般用于实现等值判断</p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CASE 变量|表达式|字段</span><br><span class="line">WHEN 要判断的值 THEN 返回的值1 或 语句1;</span><br><span class="line">WHEN 要判断的值 THEN 返回的值2 或 语句2;</span><br><span class="line">...</span><br><span class="line">ELSE 要返回的值n 或 语句n;</span><br><span class="line">END CASE;</span><br></pre></td></tr></table></figure>

<p><strong>情况2</strong>：类似于java中的多重if语句，一般用于实现区间判断<br>语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CASE </span><br><span class="line">WHEN 要判断的条件1 THEN 返回的值1 或 语句1;</span><br><span class="line">WHEN 要判断的条件2 THEN 返回的值2 或 语句2;</span><br><span class="line">...</span><br><span class="line">ELSE 要返回的值n 或 语句n;</span><br><span class="line">END case;</span><br></pre></td></tr></table></figure>

<p><strong>特点</strong><br>① 可以作为表达式，嵌套在其他语句中使用，可以放在任何地方，begin end中 或 begin end的外面<br>可以作为独立的语句去使用，只能放在begin end中<br>② 如果when中的值满足 或 条件成立，则执行对应的then后面的语句，并且结束case<br>如果不满足，则执行else中的语句或值<br>③ else可以省略，如果else省略了，并且所有when条件都不满足，则返回null</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 案例： 创建存储过程，根据传入的成绩，来显示等级，比如传入的成绩90-100，显示A，80-90，显示B，60-80，显示C，否则，显示D</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE test_case(IN score INT)</span><br><span class="line">BEGIN</span><br><span class="line">	CASE </span><br><span class="line">	WHEN score &gt;= 90 AND score &lt;= 100 THEN SELECT &#x27;A&#x27;;</span><br><span class="line">	WHEN score &gt;= 80 THEN SELECT &#x27;B&#x27;;</span><br><span class="line">	WHEN score &gt;= 60 THEN SELECT &#x27;C&#x27;;</span><br><span class="line">	ELSE SELECT &#x27;D&#x27;;</span><br><span class="line">	END CASE</span><br><span class="line">END $ </span><br><span class="line"></span><br><span class="line">CALL test_case (95) $ </span><br></pre></td></tr></table></figure>

<h4 id="6-5-2-循环结构"><a href="#6-5-2-循环结构" class="headerlink" title="6.5.2 循环结构"></a>6.5.2 循环结构</h4><p><strong>分类</strong>：while、loop、repeat</p>
<p><strong>循环控制</strong>：<br><code>iterate</code>： 类似于 continue，继续，结束本次循环，继续下一次<br><code>leave</code>：类似于 break，跳出，结束当前所在的循环</p>
<p><strong>1）while</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">【标签:】WHILE 循环条件 DO</span><br><span class="line">	循环体;</span><br><span class="line">END WHILE【 标签】;</span><br></pre></td></tr></table></figure>

<p><strong>2）loop</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">【标签:】LOOP</span><br><span class="line">	循环体;</span><br><span class="line">END LOOP 【标签】;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以用来模拟简单的死循环</p>
</blockquote>
<p><strong>3）repeat</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">【标签：】REPEAT</span><br><span class="line">	循环体;</span><br><span class="line">UNTIL 结束循环的条件</span><br><span class="line">END REPEAT 【标签】;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"># 没有添加循环控制语句</span><br><span class="line"># 案例：批量插入，根据次数到admin表中多条记录</span><br><span class="line">CREATE PROCEDURE pro_while1(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">	DECLARE i INT DEFAULT 1;</span><br><span class="line">	WHILE i &lt;= insertCount DO</span><br><span class="line">	INSERT INTO admin(username, `password`) VALUES(CONCAT(&#x27;Rose&#x27;,i), &#x27;666&#x27;);</span><br><span class="line">	SET i = i + 1;</span><br><span class="line">	END WHILE;</span><br><span class="line">	</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">CALL pro_while1(100) $</span><br><span class="line"></span><br><span class="line"># 2、添加leave语句</span><br><span class="line"># 案例：批量插入，根据次数插入到admin表中多条记录，如果次数 &gt; 20则停止</span><br><span class="line">TRUNCATE TABLE admin$</span><br><span class="line">DROP PROCEDURE test_while2 $</span><br><span class="line">CREATE PROCEDURE test_while2(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 1;</span><br><span class="line">	a:WHILE i &lt;= insertCount DO</span><br><span class="line">		INSERT INTO admin(username, `password`) VALUES(CONCAT(&#x27;xiaonhau&#x27;,i), &#x27;0000&#x27;);</span><br><span class="line">		IF i &gt; 20 THEN LEAVE a;</span><br><span class="line">		END IF;</span><br><span class="line">		SET i = i + 1;</span><br><span class="line">	END WHILE a;</span><br><span class="line">	</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">CALL test_while2(100)$</span><br><span class="line"></span><br><span class="line"># 3、添加iterate语句</span><br><span class="line"># 案例：批量插入，根据次数插入到admin表中多条记录，直插入偶数次</span><br><span class="line">TRUNCATE TABLE admin$</span><br><span class="line">DROP PROCEDURE test_while2 $</span><br><span class="line">CREATE PROCEDURE test_while3(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 0;</span><br><span class="line">	a:WHILE i &lt;= insertCount DO</span><br><span class="line">		SET i = i + 1;</span><br><span class="line">		IF MOD(i, 2) != 0 THEN ITERATE a;</span><br><span class="line">		END IF;</span><br><span class="line">		INSERT INTO admin(username, `password`) VALUES(CONCAT(&#x27;xiaohua&#x27;,i), &#x27;0000&#x27;);</span><br><span class="line">	END WHILE a;</span><br><span class="line">	</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">CALL test_while3(100)$</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">丁康健</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://actionding.github.io/2020/08/MySQL%20%E7%AC%94%E8%AE%B0/">https://actionding.github.io/2020/08/MySQL%20%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ActionDing.github.io" target="_blank">ActionDing</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="Wechat"/></a><div class="post-qr-code-desc">Wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="Alipay"/></a><div class="post-qr-code-desc">Alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/MyBatis%20%E7%AC%94%E8%AE%B0/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MyBatis 笔记</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/Java%20%E7%AC%94%E8%AE%B0/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java 笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2022/03/08/NatumZBRC4zSi8Q.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">丁康健</div><div class="author-info__description">Less is More</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ActionDing"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ActionDing" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:dingkj32@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Welcom to my Blog.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-MySQL%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">第一章 MySQL概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%B8%B8%E8%A7%81%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 数据库的常见概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-DB"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 DB</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-DBMS"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 DBMS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-SQL"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 SQL</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-MySQL%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 MySQL的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-MySQL%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 MySQL的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-MySQL%E8%AF%AD%E8%A8%80%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 MySQL语言的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-1-DML"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.4.1 DML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-2-DDL"><span class="toc-number">1.4.2.</span> <span class="toc-text">1.4.2 DDL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-3-DCL"><span class="toc-number">1.4.3.</span> <span class="toc-text">1.4.3 DCL</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-MySQL%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E5%81%9C%E6%AD%A2"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 MySQL服务的启动和停止</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-MySQL%E6%9C%8D%E5%8A%A1%E7%9A%84%E7%99%BB%E5%BD%95%E5%92%8C%E9%80%80%E5%87%BA"><span class="toc-number">1.6.</span> <span class="toc-text">1.6 MySQL服务的登录和退出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-DQL%E8%AF%AD%E8%A8%80"><span class="toc-number">2.</span> <span class="toc-text">第二章 DQL语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 基础查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E6%9F%A5%E8%AF%A2%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%8D%95%E4%B8%AA%E5%AD%97%E6%AE%B5"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 查询表中的单个字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-%E6%9F%A5%E8%AF%A2%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%A4%9A%E4%B8%AA%E5%AD%97%E6%AE%B5"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 查询表中的多个字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-3-%E6%9F%A5%E8%AF%A2%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%97%E6%AE%B5"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 查询表中的所有字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-%E6%9F%A5%E8%AF%A2%E5%B8%B8%E9%87%8F%E5%80%BC"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4 查询常量值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-5-%E6%9F%A5%E8%AF%A2%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.1.5.</span> <span class="toc-text">2.1.5 查询表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-6-%E6%9F%A5%E8%AF%A2%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.6.</span> <span class="toc-text">2.1.6 查询函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-7-%E8%B5%B7%E5%88%AB%E5%90%8D"><span class="toc-number">2.1.7.</span> <span class="toc-text">2.1.7 起别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-8-%E5%8E%BB%E9%87%8D"><span class="toc-number">2.1.8.</span> <span class="toc-text">2.1.8 去重</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-9-%E5%8F%B7%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.1.9.</span> <span class="toc-text">2.1.9 +号的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%84%EF%BC%9A%E5%87%A0%E4%B8%AA%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.10.</span> <span class="toc-text">附：几个函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 条件查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-%E7%AE%80%E5%8D%95%E6%9D%A1%E4%BB%B6%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 简单条件运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 逻辑运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2.3 模糊查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 排序查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-%E8%AF%AD%E6%B3%95"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-%E7%89%B9%E7%82%B9"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%84%EF%BC%9A%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0"><span class="toc-number">2.3.3.</span> <span class="toc-text">附：常见函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 分组函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1-%E5%8A%9F%E8%83%BD"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1 功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-2-%E5%88%86%E7%B1%BB"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2 分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-3-%E7%89%B9%E7%82%B9"><span class="toc-number">2.4.3.</span> <span class="toc-text">2.4.3 特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1-%E8%AF%AD%E6%B3%95"><span class="toc-number">2.5.1.</span> <span class="toc-text">2.5.1 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-%E7%89%B9%E7%82%B9"><span class="toc-number">2.5.2.</span> <span class="toc-text">2.5.2 特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.6.</span> <span class="toc-text">2.5 连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1-%E5%90%AB%E4%B9%89"><span class="toc-number">2.6.1.</span> <span class="toc-text">2.5.1 含义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-%E5%88%86%E7%B1%BB"><span class="toc-number">2.6.2.</span> <span class="toc-text">2.5.2 分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-3-sql92%E6%A0%87%E5%87%86"><span class="toc-number">2.6.3.</span> <span class="toc-text">2.5.3 sql92标准</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-4-sql99%E6%A0%87%E5%87%86"><span class="toc-number">2.6.4.</span> <span class="toc-text">2.5.4 sql99标准</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.7.</span> <span class="toc-text">2.6 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-1-%E5%90%AB%E4%B9%89"><span class="toc-number">2.7.1.</span> <span class="toc-text">2.6.1 含义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-2-%E5%88%86%E7%B1%BB"><span class="toc-number">2.7.2.</span> <span class="toc-text">2.6.2 分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-3-where-%E6%88%96-having-%E5%90%8E%E9%9D%A2"><span class="toc-number">2.7.3.</span> <span class="toc-text">2.6.3 where 或 having 后面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-4-select%E5%90%8E%E9%9D%A2"><span class="toc-number">2.7.4.</span> <span class="toc-text">2.6.4 select后面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-5-from%E5%90%8E%E9%9D%A2"><span class="toc-number">2.7.5.</span> <span class="toc-text">2.6.5 from后面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-6-exists%E5%90%8E%E9%9D%A2%EF%BC%88%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-number">2.7.6.</span> <span class="toc-text">2.6.6 exists后面（相关子查询）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.8.</span> <span class="toc-text">2.7 分页查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-1-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.8.1.</span> <span class="toc-text">2.7.1 应用场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-2-%E8%AF%AD%E6%B3%95"><span class="toc-number">2.8.2.</span> <span class="toc-text">2.7.2 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-3-%E7%89%B9%E7%82%B9"><span class="toc-number">2.8.3.</span> <span class="toc-text">2.7.3 特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.9.</span> <span class="toc-text">2.8 联合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-1-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.9.1.</span> <span class="toc-text">2.8.1 应用场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-2-%E8%AF%AD%E6%B3%95"><span class="toc-number">2.9.2.</span> <span class="toc-text">2.8.2 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-3-%E7%89%B9%E7%82%B9%E2%98%85"><span class="toc-number">2.9.3.</span> <span class="toc-text">2.8.3 特点★</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-DML%E8%AF%AD%E8%A8%80"><span class="toc-number">3.</span> <span class="toc-text">第三章 DML语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%8F%92%E5%85%A5%E8%AF%AD%E8%A8%80"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 插入语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E6%96%B9%E5%BC%8F%E4%B8%80"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 方式一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E6%96%B9%E5%BC%8F%E4%BA%8C"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2 方式二</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3 两种方式对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E4%BF%AE%E6%94%B9%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 修改语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E4%BF%AE%E6%94%B9%E5%8D%95%E8%A1%A8%E7%9A%84%E8%AE%B0%E5%BD%95%E2%98%85"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 修改单表的记录★</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E4%BF%AE%E6%94%B9%E5%A4%9A%E8%A1%A8%E7%9A%84%E8%AE%B0%E5%BD%95%E3%80%90%E8%A1%A5%E5%85%85%E3%80%91"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 修改多表的记录【补充】</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%88%A0%E9%99%A4%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.3.</span> <span class="toc-text">3.4 删除语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9Adelete"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.4.1 方式一：delete</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9Atruncate"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.4.2 方式二：truncate</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-DDL%E8%AF%AD%E8%A8%80"><span class="toc-number">4.</span> <span class="toc-text">第四章 DDL语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%BA%93%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 库的管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E5%BA%93%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">4.1.1.</span> <span class="toc-text">4.1.1 库的创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-%E5%BA%93%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">4.1.2.</span> <span class="toc-text">4.1.2 库的修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-3-%E5%BA%93%E7%9A%84%E5%88%A0%E9%99%A4"><span class="toc-number">4.1.3.</span> <span class="toc-text">4.1.3 库的删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E8%A1%A8%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 表的管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 表的创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E8%A1%A8%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2 表的修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-%E8%A1%A8%E7%9A%84%E5%88%A0%E9%99%A4"><span class="toc-number">4.2.3.</span> <span class="toc-text">4.2.3 表的删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4-%E8%A1%A8%E7%9A%84%E5%A4%8D%E5%88%B6"><span class="toc-number">4.2.4.</span> <span class="toc-text">4.2.4 表的复制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E5%88%86%E7%B1%BB"><span class="toc-number">4.3.1.</span> <span class="toc-text">4.3.1 分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E6%95%B4%E5%9E%8B"><span class="toc-number">4.3.2.</span> <span class="toc-text">4.3.2 整型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-%E5%B0%8F%E6%95%B0"><span class="toc-number">4.3.3.</span> <span class="toc-text">4.3.3 小数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-4-%E5%AD%97%E7%AC%A6%E5%9E%8B"><span class="toc-number">4.3.4.</span> <span class="toc-text">4.3.4 字符型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-5-%E6%97%A5%E6%9C%9F%E5%9E%8B"><span class="toc-number">4.3.5.</span> <span class="toc-text">4.3.5 日期型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E7%BA%A6%E6%9D%9F"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-%E5%90%AB%E4%B9%89"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.4.1 含义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-%E5%88%86%E7%B1%BB"><span class="toc-number">4.4.2.</span> <span class="toc-text">4.4.2 分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-%E7%BA%A6%E6%9D%9F%E7%9A%84%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BB"><span class="toc-number">4.4.3.</span> <span class="toc-text">4.4.3 约束的添加分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-4-%E8%AF%AD%E6%B3%95"><span class="toc-number">4.4.4.</span> <span class="toc-text">4.4.4 语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E6%A0%87%E8%AF%86%E5%88%97"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 标识列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-1-%E5%90%AB%E4%B9%89"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.5.1 含义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-2-%E7%89%B9%E7%82%B9"><span class="toc-number">4.5.2.</span> <span class="toc-text">4.5.2 特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-3-%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E8%AE%BE%E7%BD%AE%E6%A0%87%E8%AF%86%E5%88%97"><span class="toc-number">4.5.3.</span> <span class="toc-text">4.5.3 创建表时设置标识列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-4-%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%97%B6%E8%AE%BE%E7%BD%AE%E6%A0%87%E8%AF%86%E5%88%97"><span class="toc-number">4.5.4.</span> <span class="toc-text">4.5.4 修改表时设置标识列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-5-%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%97%B6%E5%88%A0%E9%99%A4%E6%A0%87%E8%AF%86%E5%88%97"><span class="toc-number">4.5.5.</span> <span class="toc-text">4.5.5 修改表时删除标识列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-TCL%E8%AF%AD%E8%A8%80"><span class="toc-number">5.</span> <span class="toc-text">第五章 TCL语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 事务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E6%A6%82%E5%BF%B5"><span class="toc-number">5.1.1.</span> <span class="toc-text">5.1.1 概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2%E7%89%B9%E6%80%A7"><span class="toc-number">5.1.2.</span> <span class="toc-text">5.1.2特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3-%E5%88%86%E7%B1%BB"><span class="toc-number">5.1.3.</span> <span class="toc-text">5.1.3 分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 事务的创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%B9%B6%E5%8F%91%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 并发事务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%85%B6%E4%BB%96"><span class="toc-number">6.</span> <span class="toc-text">第六章 其他</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E8%A7%86%E5%9B%BE"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-1-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="toc-number">6.1.1.</span> <span class="toc-text">6.1.1 创建视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-2-%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">6.1.2.</span> <span class="toc-text">6.1.2 视图的修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-3-%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-number">6.1.3.</span> <span class="toc-text">6.1.3 删除视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-4-%E6%9F%A5%E7%9C%8B%E8%A7%86%E5%9B%BE"><span class="toc-number">6.1.4.</span> <span class="toc-text">6.1.4 查看视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-5-%E8%A7%86%E5%9B%BE%E7%9A%84%E6%9B%B4%E6%96%B0"><span class="toc-number">6.1.5.</span> <span class="toc-text">6.1.5 视图的更新</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%8F%98%E9%87%8F"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-1-%E5%88%86%E7%B1%BB"><span class="toc-number">6.2.1.</span> <span class="toc-text">6.2.1 分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-2-%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">6.2.2.</span> <span class="toc-text">6.2.2 系统变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">6.2.3.</span> <span class="toc-text">6.2.3 自定义变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-1-%E5%88%9B%E5%BB%BA%E8%AF%AD%E6%B3%95"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1 创建语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-2-%E8%B0%83%E7%94%A8%E8%AF%AD%E6%B3%95"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2 调用语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-3-%E5%88%A0%E9%99%A4%E8%AF%AD%E6%B3%95"><span class="toc-number">6.3.3.</span> <span class="toc-text">6.3.3 删除语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-4-%E6%9F%A5%E7%9C%8B%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-number">6.3.4.</span> <span class="toc-text">6.3.4 查看存储过程的信息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E5%87%BD%E6%95%B0"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-1-%E5%88%9B%E5%BB%BA%E8%AF%AD%E6%B3%95"><span class="toc-number">6.4.1.</span> <span class="toc-text">6.4.1 创建语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-2-%E8%B0%83%E7%94%A8%E8%AF%AD%E6%B3%95"><span class="toc-number">6.4.2.</span> <span class="toc-text">6.4.2 调用语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-3-%E6%9F%A5%E7%9C%8B%E5%87%BD%E6%95%B0"><span class="toc-number">6.4.3.</span> <span class="toc-text">6.4.3 查看函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-4-%E5%88%A0%E9%99%A4%E5%87%BD%E6%95%B0"><span class="toc-number">6.4.4.</span> <span class="toc-text">6.4.4 删除函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-5-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">6.4.5.</span> <span class="toc-text">6.4.5 存储过程和函数的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E8%BF%87%E7%A8%8B"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 流程控制过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-1-%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84"><span class="toc-number">6.5.1.</span> <span class="toc-text">6.5.1 分支结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-2-%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">6.5.2.</span> <span class="toc-text">6.5.2 循环结构</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 丁康健</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>